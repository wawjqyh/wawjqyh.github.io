# 关机与重启命令

直接断掉电源的方式来关闭linux，这是十分危险的。因为linux与windows不同，其后台运行着许多进程，所以强制关机可能会导致进程的
数据丢失,使系统处于不稳定的状态,甚至在有的系统中会损坏硬件设备。

## shutdown

系统关机前使用shutdown命令,系统管理员会通知所有登录的用户系统将要关闭,并且login指令会被冻结,即新的用户不能再登录。直接关
机或者延迟一定的时间才关机都是可能的,还可能重启。这是由所有进程〔process〕都会收到系统所送达的信号〔signal〕决定的。这让
像vi之类的程序有时间储存目前正在编辑的文档,而像处理邮件〔mail〕和新闻〔news〕的程序则可以正常地离开等等。 shutdown执行它
的工作是送信号〔signal〕给init程序,要求它改变runlevel。

* `runlevel 0` 被用来停机〔halt〕
* `runlevel 6` 是用来重新激活〔reboot〕系统
* `runlevel 1` 则是被用来让系统进入管理工作可以进行的状态

```javascript
shutdown [选项] [时间]
```

* `-c` 取消前一个关机命令
* `-h` 关机后关闭电源〔halt〕
* `-r` 重启

在某个时间关机

```javascript
shutdown -h 02:15       //执行这个命令后就不能再进行其他的操作
shutdown -h 02:15 &     //&符号会将命令放到后台运行，这时还可以进行其他的操作
shutdown +5             //5分钟后关机
```

<p class="warning">&符号会将命令放到后台运行，这时还可以进行其他的操作</p>

## halt

halt就是调用shutdown -h。halt执行时，杀死应用进程，执行sync系统调用，文件系统写操作完成后就会停止内核

## reboot

reboot 的工作过程差不多跟halt一样，不过它是引发主机重启，而halt是关机

## init

init 是所有进程的祖先，它的进程号始终为1，所以发送TERM信号给init会终止所有的 用户进程，守护进程等。shutdown 就是使用这种
机制。init定义了7个运行级别(runlevel)

所谓的init进程，它是一个由内核启动的用户级进程。内核自行启动（已经被载入内存，开始运行，并已初始化所有的设备驱动程序和数
据结构等）之后，就通过启动一个用户级程序init的方式，完成引导进程。所以,init始终是第一个进程（其进程编号始终为1）。内核会
在过去曾使用过init的几个地方查找它，它的正确位置（对Linux系统来说）是/sbin/init。如果内核找不到 init，它就会试着运行/bin/sh，
如果运行失败，系统的启动也会失败

```javascript
init 0          //关机
init 6          //重启
```

### 运行级别

运行级就是操作系统当前正在运行的功能级别。这个级别从1到6 ，具有不同的功能

* `0` 停机（千万不能把initdefault 设置为0 ） 　　
* `1` 单用户模式 　
* `2` 多用户，没有 NFS（文件共享服务）
* `3` 完全多用户模式(标准的运行级) 　
* `4` 没有用到 　
* `5` X11 （xwindow)图形界面
* `6` 重新启动 （千万不要把initdefault 设置为6 ）

查看当前运行级别

```javascript
runlevel        //查询当前运行级别
```

## 退出登录

结束远程登录操作后，一定要退出登录

```
logout
```