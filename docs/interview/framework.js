(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["docs/interview/framework"],{By6U:function(e,t,o){var n=o("Rxnk"),i=o("q0tk"),c=o("/eRU"),d=o("HYe4"),r=o("H3s+"),a=o("qoZZ"),s=o("6OGs"),l=n(i),p=n(c),u=n(d),h=n(r),g=n(a),m=n(s),v='<h1 id="\u6846\u67b6\u76f8\u5173">\u6846\u67b6\u76f8\u5173</h1> <h2 id="1-\u5408\u6210\u4e8b\u4ef6">1 \u5408\u6210\u4e8b\u4ef6</h2> <h3 id="11-\u77e5\u8bc6\u70b9">1.1 \u77e5\u8bc6\u70b9</h3> <p><strong>\u5408\u6210\u4e8b\u4ef6\u7684\u7279\u70b9\uff1a</strong></p> <ol> <li><code>React</code> \u4e0a\u6ce8\u518c\u7684\u4e8b\u4ef6\u6700\u7ec8\u4f1a\u7ed1\u5b9a\u5728 <code>document</code> \u8fd9\u4e2a <code>DOM</code> \u4e0a\uff0c\u800c\u4e0d\u662f <code>React</code> \u7ec4\u4ef6\u5bf9\u5e94\u7684 DOM(\u51cf\u5c11\u5185\u5b58\u5f00\u9500\u5c31\u662f\u56e0\u4e3a\u6240\u6709\u7684\u4e8b\u4ef6\u90fd\u7ed1\u5b9a\u5728 <code>document</code> \u4e0a\uff0c\u5176\u4ed6\u8282\u70b9\u6ca1\u6709\u7ed1\u5b9a\u4e8b\u4ef6)</li> <li><code>React</code> \u81ea\u8eab\u5b9e\u73b0\u4e86\u4e00\u5957\u4e8b\u4ef6\u5192\u6ce1\u673a\u5236\uff0c\u6240\u4ee5\u8fd9\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u6211\u4eec <code>event.stopPropagation()</code> \u65e0\u6548\u7684\u539f\u56e0\u3002</li> <li><code>React</code> \u901a\u8fc7\u961f\u5217\u7684\u5f62\u5f0f\uff0c\u4ece\u89e6\u53d1\u7684\u7ec4\u4ef6\u5411\u7236\u7ec4\u4ef6\u56de\u6eaf\uff0c\u7136\u540e\u8c03\u7528\u4ed6\u4eec <code>JSX</code> \u4e2d\u5b9a\u4e49\u7684 <code>callback</code></li> <li><code>React</code> \u6709\u4e00\u5957\u81ea\u5df1\u7684\u5408\u6210\u4e8b\u4ef6 <code>SyntheticEvent</code>\uff0c\u4e0d\u662f\u539f\u751f\u7684\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u81ea\u5df1\u53bb\u770b\u5b98\u7f51</li> <li><code>React</code> \u901a\u8fc7\u5bf9\u8c61\u6c60\u7684\u5f62\u5f0f\u7ba1\u7406\u5408\u6210\u4e8b\u4ef6\u5bf9\u8c61\u7684\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u51cf\u5c11\u4e86\u5783\u573e\u7684\u751f\u6210\u548c\u65b0\u5bf9\u8c61\u5185\u5b58\u7684\u5206\u914d\uff0c\u63d0\u9ad8\u4e86\u6027\u80fd</li> </ol> <h3 id="12-\u9898\u76ee\uff1areact-\u4e3a\u4ec0\u4e48\u9700\u8981\u5408\u6210\u4e8b\u4ef6">1.2 \u9898\u76ee\uff1areact \u4e3a\u4ec0\u4e48\u9700\u8981\u5408\u6210\u4e8b\u4ef6</h3> <ul> <li><code>React</code> \u4f7f\u7528\u4e86\u4e8b\u4ef6\u4ee3\u7406\uff0c<code>React</code> \u4e0a\u6ce8\u518c\u7684\u4e8b\u4ef6\u6700\u7ec8\u4f1a\u7ed1\u5b9a\u5728 <code>document</code> \u8fd9\u4e2a <code>DOM</code> \u4e0a</li> <li>\u6d88\u9664\u4e86\u6d4f\u89c8\u5668\u4e4b\u95f4\u7684\u517c\u5bb9\u6027\u95ee\u9898</li> <li>\u63d0\u9ad8\u6027\u80fd</li> </ul> <h3 id="13-\u9898\u76ee\uff1areact-\u5408\u6210\u4e8b\u4ef6\u662f\u4ec0\u4e48\uff0c\u548c\u539f\u751f\u4e8b\u4ef6\u7684\u533a\u522b">1.3 \u9898\u76ee\uff1areact \u5408\u6210\u4e8b\u4ef6\u662f\u4ec0\u4e48\uff0c\u548c\u539f\u751f\u4e8b\u4ef6\u7684\u533a\u522b</h3> <p><strong>react \u5408\u6210\u4e8b\u4ef6\u662f\u4ec0\u4e48\uff1a</strong></p> <blockquote> <p>\u5408\u6210\u4e8b\u4ef6\u662f react \u81ea\u5df1\u6784\u5efa\u7684\uff0c\u5bf9\u539f\u751f\u4e8b\u4ef6\u8fdb\u884c\u4e86\u5305\u88c5\u3002<code>React</code> \u4e0a\u6ce8\u518c\u7684\u4e8b\u4ef6\u6700\u7ec8\u4f1a\u7ed1\u5b9a\u5728 <code>document</code> \u8fd9\u4e2a <code>DOM</code> \u4e0a\uff0c\u800c\u4e0d\u662f <code>React</code> \u7ec4\u4ef6\u5bf9\u5e94\u7684 DOM</p> </blockquote> <ul> <li>\u901a\u8fc7 <code>JSX</code> \u65b9\u5f0f\u7ed1\u5b9a\u7684\u4e8b\u4ef6\u5c31\u662f\u5408\u6210\u4e8b\u4ef6</li> <li>\u901a\u8fc7 <code>addEventListener</code> \u7ed1\u5b9a\u7684\u4e8b\u4ef6\u5c31\u662f\u539f\u751f\u4e8b\u4ef6</li> </ul> <p><strong>\u5408\u6210\u4e8b\u4ef6\u548c\u539f\u751f\u4e8b\u4ef6\u7684\u533a\u522b\uff1a</strong></p> <ul> <li>\u5408\u6210\u4e8b\u4ef6\u5bf9\u539f\u751f\u4e8b\u4ef6\u8fdb\u884c\u4e86\u5305\u88c5\uff0c\u53ef\u4ee5\u517c\u5bb9\u6240\u6709\u6d4f\u89c8\u5668</li> <li>\u5b83\u8fd8\u62e5\u6709\u548c\u6d4f\u89c8\u5668\u539f\u751f\u4e8b\u4ef6\u76f8\u540c\u7684\u63a5\u53e3\uff0c\u5305\u62ec <code>stopPropagation()</code> \u548c <code>preventDefault()</code></li> <li>\u4f46\u662f\u8fd9\u4e9b\u63a5\u53e3\u662f\u9488\u5bf9\u5b83\u81ea\u5df1\u7684\u4e8b\u4ef6\u673a\u5236\u7684\uff0c\u8ddf\u539f\u751f\u4e8b\u4ef6\u7684 <code>stopPropagation</code> \u4e0d\u662f\u540c\u4e00\u4e2a\u4e1c\u897f</li> <li>\u53ef\u4ee5\u901a\u8fc7 <code>nativeEvent</code> \u5c5e\u6027\u6765\u83b7\u53d6\u6d4f\u89c8\u5668\u7684\u5e95\u5c42\u4e8b\u4ef6</li> </ul> <h2 id="2-virtual-dom">2 virtual dom</h2> <p><strong>\u4ec0\u4e48\u662f virtual dom\uff1a</strong></p> <ul> <li>\u662f\u4e00\u4e2a\u7b80\u5355\u7684 JS \u5bf9\u8c61\uff0c\u7528\u6765\u6a21\u62df dom \u6811\uff0c\u800c\u4e0d\u662f\u64cd\u4f5c\u771f\u5b9e\u7684 dom</li> <li>\u8fd9\u6837\u5c31\u65b9\u4fbf\u505a\u4e00\u4e9b\u6027\u80fd\u4f18\u5316\uff0c\u4e0d\u4f1a\u9891\u7e41\u6e32\u67d3\u9875\u9762</li> </ul> <p><strong>diff \u7b97\u6cd5\uff1a</strong></p> <ul> <li>\u5f53\u5185\u5bb9\u6709\u6539\u53d8\u7684\u65f6\u5019\uff0c\u4f1a\u5c06\u65e7\u7684\u865a\u62df dom \u548c\u65b0\u7684\u865a\u62df dom \u505a\u5bf9\u6bd4</li> <li>\u627e\u51fa\u53d8\u66f4\u7684\u8282\u70b9\uff0c\u53ea\u66f4\u65b0\u53d8\u66f4\u7684\u8282\u70b9\uff0c\u63d0\u9ad8\u6027\u80fd</li> <li>diff \u7b97\u6cd5\uff0c\u9010\u7ea7\u6bd4\u8f83\u4e24\u4e2a\u6811</li> <li>\u5982\u679c\u7528\u5faa\u73af\u751f\u6210\u4e00\u7ec4\u76f8\u540c\u7684\u8282\u70b9\uff0c\u901a\u5e38\u9700\u8981\u6dfb\u52a0 key \u5c5e\u6027\uff0c\u7528\u6765\u5224\u65ad\u8282\u70b9\u662f\u5426\u8981\u66f4\u65b0</li> </ul> <p><img src="'+l+'" alt=""></p> <h2 id="3-setstate-\u8fc7\u7a0b">3 setState \u8fc7\u7a0b</h2> <h3 id="31-setstate-\u6267\u884c\u8fc7\u7a0b">3.1 setState \u6267\u884c\u8fc7\u7a0b</h3> <p><img src="'+p+'" alt=""></p> <p><strong>\u8bf4\u660e\uff1a</strong></p> <ul> <li><code>partialState</code>\uff1a<code>setState</code> \u4f20\u5165\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u5bf9\u8c61\u6216\u51fd\u6570</li> <li><code>_pendingStateQueue</code>\uff1a\u5f53\u524d\u7ec4\u4ef6\u7b49\u5f85\u6267\u884c\u66f4\u65b0\u7684 <code>state</code> \u961f\u5217</li> <li><code>isBatchingUpdates</code>\uff1a<code>react</code> \u7528\u4e8e\u6807\u8bc6\u5f53\u524d\u662f\u5426\u5904\u4e8e\u6279\u91cf\u66f4\u65b0\u72b6\u6001\uff0c\u6240\u6709\u7ec4\u4ef6\u516c\u7528</li> <li><code>dirtyComponent</code>\uff1a\u5f53\u524d\u6240\u6709\u5904\u4e8e\u5f85\u66f4\u65b0\u72b6\u6001\u7684\u7ec4\u4ef6\u961f\u5217</li> <li><code>transcation</code>\uff1a<code>react</code> \u7684\u4e8b\u52a1\u673a\u5236\uff0c\u5728\u88ab\u4e8b\u52a1\u8c03\u7528\u7684\u65b9\u6cd5\u5916\u5305\u88c5 <code>n</code> \u4e2a <code>waper</code> \u5bf9\u8c61\uff0c\u5e76\u4e00\u6b21\u6267\u884c\uff1a<code>waper.init</code>\u3001\u88ab\u8c03\u7528\u65b9\u6cd5\u3001<code>waper.close</code></li> <li><code>FLUSH_BATCHED_UPDATES</code>\uff1a\u7528\u4e8e\u6267\u884c\u66f4\u65b0\u7684 <code>waper</code>\uff0c\u53ea\u6709\u4e00\u4e2a <code>close</code> \u65b9\u6cd5</li> </ul> <p><strong>setState \u6267\u884c\u8fc7\u7a0b\uff1a</strong></p> <ol> <li>\u5c06 <code>setState</code> \u4f20\u5165\u7684 <code>partialState</code> \u53c2\u6570\u5b58\u50a8\u5728\u5f53\u524d\u7ec4\u4ef6\u5b9e\u4f8b\u7684 <code>state</code> \u6682\u5b58\u961f\u5217\u4e2d</li> <li>\u5224\u65ad\u5f53\u524d React \u662f\u5426\u5904\u4e8e\u6279\u91cf\u66f4\u65b0\u72b6\u6001\uff0c\u5982\u679c\u662f\uff0c\u5c06\u5f53\u524d\u7ec4\u4ef6\u52a0\u5165\u5f85\u66f4\u65b0\u7684\u7ec4\u4ef6\u961f\u5217\u4e2d</li> <li>\u5982\u679c\u672a\u5904\u4e8e\u6279\u91cf\u66f4\u65b0\u72b6\u6001\uff0c\u5c06\u6279\u91cf\u66f4\u65b0\u72b6\u6001\u6807\u8bc6\u8bbe\u7f6e\u4e3a <code>true</code>\uff0c\u7528\u4e8b\u52a1\u518d\u6b21\u8c03\u7528\u524d\u4e00\u6b65\u65b9\u6cd5\uff0c\u4fdd\u8bc1\u5f53\u524d\u7ec4\u4ef6\u52a0\u5165\u5230\u4e86\u5f85\u66f4\u65b0\u7ec4\u4ef6\u961f\u5217\u4e2d</li> <li>\u8c03\u7528\u4e8b\u52a1\u7684 <code>waper</code> \u65b9\u6cd5\uff0c\u904d\u5386\u5f85\u66f4\u65b0\u7ec4\u4ef6\u961f\u5217\u4f9d\u6b21\u6267\u884c\u66f4\u65b0</li> <li>\u6267\u884c\u751f\u547d\u5468\u671f <code>componentWillReceiveProps</code></li> <li>\u5c06\u7ec4\u4ef6\u7684 <code>state</code> \u6682\u5b58\u961f\u5217\u4e2d\u7684 <code>state</code> \u8fdb\u884c\u5408\u5e76\uff0c\u83b7\u5f97\u6700\u7ec8\u8981\u66f4\u65b0\u7684 <code>state</code> \u5bf9\u8c61\uff0c\u5e76\u5c06\u961f\u5217\u7f6e\u4e3a\u7a7a</li> <li>\u6267\u884c\u751f\u547d\u5468\u671f <code>componentShouldUpdate</code>\uff0c\u6839\u636e\u8fd4\u56de\u503c\u5224\u65ad\u662f\u5426\u8981\u7ee7\u7eed\u66f4\u65b0</li> <li>\u6267\u884c\u751f\u547d\u5468\u671f <code>componentWillUpdate</code></li> <li>\u6267\u884c\u771f\u6b63\u7684\u66f4\u65b0\uff0c<code>render</code></li> <li>\u6267\u884c\u751f\u547d\u5468\u671f <code>componentDidUpdate</code></li> </ol> <h3 id="32-react-setstate-\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65">3.2 react setState \u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65</h3> <p>\u5206\u4e24\u4e2a\u60c5\u51b5\uff1a</p> <ol> <li>\u94a9\u5b50\u51fd\u6570\u548c React \u5408\u6210\u4e8b\u4ef6\u4e2d\u7684 setState\uff0c\u5f02\u6b65</li> <li>\u5f02\u6b65\u51fd\u6570\u548c\u539f\u751f\u4e8b\u4ef6\u4e2d\u7684 setstate\uff0c\u540c\u6b65</li> </ol> <h3 id="33-\u94a9\u5b50\u51fd\u6570\u548c-react-\u5408\u6210\u4e8b\u4ef6\u4e2d">3.3 \u94a9\u5b50\u51fd\u6570\u548c React \u5408\u6210\u4e8b\u4ef6\u4e2d</h3> <p><strong>\u94a9\u5b50\u51fd\u6570\u548c React \u5408\u6210\u4e8b\u4ef6\u4e2d\u7684 setState\uff1a</strong></p> <pre><code class="language-js">class TestState {\n  componentDidMount() {\n    console.log(&#39;SetState\u8c03\u7528setState&#39;);\n    this.setState({\n      index: this.state.index + 1\n    });\n    console.log(&#39;state&#39;, this.state.index);\n\n    console.log(&#39;SetState\u8c03\u7528setState&#39;);\n    this.setState({\n      index: this.state.index + 1\n    });\n    console.log(&#39;state&#39;, this.state.index);\n  }\n}</code></pre> <p><img src="'+u+'" alt=""></p> <p><strong>\u8bf4\u660e\uff1a</strong></p> <ol> <li>\u8c03\u7528 setState \u4e0d\u4f1a\u7acb\u5373\u66f4\u65b0</li> <li>\u6240\u6709\u7ec4\u4ef6\u4f7f\u7528\u7684\u662f\u540c\u4e00\u5957\u66f4\u65b0\u673a\u5236\uff0c\u5f53\u6240\u6709\u7ec4\u4ef6 didmount \u540e\uff0c\u7236\u7ec4\u4ef6 didmount\uff0c\u7136\u540e\u6267\u884c\u66f4\u65b0</li> <li>\u66f4\u65b0\u65f6\u4f1a\u628a\u6bcf\u4e2a\u7ec4\u4ef6\u7684\u66f4\u65b0\u5408\u5e76\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u53ea\u4f1a\u89e6\u53d1\u4e00\u6b21\u66f4\u65b0\u7684\u751f\u547d\u5468\u671f</li> </ol> <p><strong>\u539f\u56e0\uff1a</strong></p> <ol> <li>\u5728 <code>react</code> \u7684\u751f\u547d\u5468\u671f\u548c\u5408\u6210\u4e8b\u4ef6\u4e2d\uff0c<code>react</code> \u4ecd\u7136\u5904\u4e8e\u4ed6\u7684\u66f4\u65b0\u673a\u5236\u4e2d\uff0c\u8fd9\u65f6 <code>isBranchUpdate</code> \u4e3a <code>true</code></li> <li>\u6309\u7167\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u8fd9\u65f6\u65e0\u8bba\u8c03\u7528\u591a\u5c11\u6b21 <code>setState</code>\uff0c\u90fd\u4f1a\u4e0d\u4f1a\u6267\u884c\u66f4\u65b0\uff0c\u800c\u662f\u5c06\u8981\u66f4\u65b0\u7684 <code>state</code> \u5b58\u5165 <code>_pendingStateQueue</code>\uff0c\u5c06\u8981\u66f4\u65b0\u7684\u7ec4\u4ef6\u5b58\u5165 <code>dirtyComponent</code></li> <li>\u5f53\u4e0a\u4e00\u6b21\u66f4\u65b0\u673a\u5236\u6267\u884c\u5b8c\u6bd5\uff0c\u4ee5\u751f\u547d\u5468\u671f\u4e3a\u4f8b\uff0c\u6240\u6709\u7ec4\u4ef6\uff0c\u5373\u6700\u9876\u5c42\u7ec4\u4ef6 <code>didmount</code> \u540e\u4f1a\u5c06 <code>isBranchUpdate</code> \u8bbe\u7f6e\u4e3a <code>false</code>\u3002\u8fd9\u65f6\u5c06\u6267\u884c\u4e4b\u524d\u7d2f\u79ef\u7684 <code>setState</code></li> </ol> <h3 id="34-\u5f02\u6b65\u51fd\u6570\u548c\u539f\u751f\u4e8b\u4ef6\u4e2d">3.4 \u5f02\u6b65\u51fd\u6570\u548c\u539f\u751f\u4e8b\u4ef6\u4e2d</h3> <p><strong>\u5f02\u6b65\u51fd\u6570\u548c\u539f\u751f\u4e8b\u4ef6\u4e2d\u7684 setstate\uff1a</strong></p> <pre><code class="language-js">class TestState {\n  componentDidMount() {\n    setTimeout(() =&gt; {\n      console.log(&#39;\u8c03\u7528setState&#39;);\n      this.setState({\n        index: this.state.index + 1\n      });\n      console.log(&#39;state&#39;, this.state.index);\n      console.log(&#39;\u8c03\u7528setState&#39;);\n      this.setState({\n        index: this.state.index + 1\n      });\n      console.log(&#39;state&#39;, this.state.index);\n    }, 0);\n  }\n}</code></pre> <p><img src="'+h+'" alt=""></p> <p><strong>\u8bf4\u660e\uff1a</strong></p> <ol> <li>\u5728\u7236\u7ec4\u4ef6 <code>didmount</code> \u540e\u6267\u884c</li> <li>\u8c03\u7528 <code>setState</code> \u540c\u6b65\u66f4\u65b0</li> </ol> <p><strong>\u539f\u56e0\uff1a</strong></p> <ol> <li>\u7531\u6267\u884c\u673a\u5236\u770b\uff0c<code>setState</code> \u672c\u8eab\u5e76\u4e0d\u662f\u5f02\u6b65\u7684\uff0c\u800c\u662f\u5982\u679c\u5728\u8c03\u7528 <code>setState</code> \u65f6\uff0c\u5982\u679c <code>react</code> \u6b63\u5904\u4e8e\u66f4\u65b0\u8fc7\u7a0b\uff0c\u5f53\u524d\u66f4\u65b0\u4f1a\u88ab\u6682\u5b58\uff0c\u7b49\u4e0a\u4e00\u6b21\u66f4\u65b0\u6267\u884c\u540e\u5728\u6267\u884c\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u7ed9\u4eba\u4e00\u79cd\u5f02\u6b65\u7684\u5047\u8c61</li> <li>\u5728\u751f\u547d\u5468\u671f\uff0c\u6839\u636e JS \u7684\u5f02\u6b65\u673a\u5236\uff0c\u4f1a\u5c06\u5f02\u6b65\u51fd\u6570\u5148\u6682\u5b58\uff0c\u7b49\u6240\u6709\u540c\u6b65\u4ee3\u7801\u6267\u884c\u5b8c\u6bd5\u540e\u5728\u6267\u884c\uff0c\u8fd9\u65f6\u4e0a\u4e00\u6b21\u66f4\u65b0\u8fc7\u7a0b\u5df2\u7ecf\u6267\u884c\u5b8c\u6bd5\uff0c<code>isBranchUpdate</code> \u88ab\u8bbe\u7f6e\u4e3a <code>false</code>\uff0c\u6839\u636e\u4e0a\u9762\u7684\u6d41\u7a0b\uff0c\u8fd9\u65f6\u518d\u8c03\u7528 <code>setState</code> \u5373\u53ef\u7acb\u5373\u6267\u884c\u66f4\u65b0\uff0c\u62ff\u5230\u66f4\u65b0\u7ed3\u679c</li> </ol> <h3 id="35-\u4e3a\u4ec0\u4e48\u6709\u65f6-react-\u4e24\u6b21-setstate-\u53ea\u6267\u884c\u4e00\u6b21">3.5 \u4e3a\u4ec0\u4e48\u6709\u65f6 react \u4e24\u6b21 setState \u53ea\u6267\u884c\u4e00\u6b21</h3> <ol> <li>\u76f4\u63a5\u4f20\u9012\u5bf9\u8c61\u7684 <code>setstate</code> \u4f1a\u88ab\u5408\u5e76\u6210\u4e00\u6b21</li> <li>\u4f7f\u7528\u51fd\u6570\u4f20\u9012 <code>state</code> \u4e0d\u4f1a\u88ab\u5408\u5e76</li> </ol> <pre><code class="language-js">this.setState(\n  preState =&gt; ({ index: preState.index + 1 }),\n  () =&gt; {\n    console.log(this.state.index);\n  }\n);</code></pre> <h3 id="36-\u9898\u76ee\uff1a-react-setstate-\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65">3.6 \u9898\u76ee\uff1a react setState \u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65</h3> <h3 id="37-\u9898\u76ee\uff1a\u4e3a\u4ec0\u4e48\u6709\u65f6-react-\u4e24\u6b21-setstate\uff0c\u53ea\u6267\u884c\u4e00\u6b21">3.7 \u9898\u76ee\uff1a\u4e3a\u4ec0\u4e48\u6709\u65f6 react \u4e24\u6b21 setState\uff0c\u53ea\u6267\u884c\u4e00\u6b21</h3> <h2 id="4-fiber">4 fiber</h2> <h3 id="41-\u77e5\u8bc6\u70b9">4.1 \u77e5\u8bc6\u70b9</h3> <p><strong>\u4e3a\u4ec0\u4e48\u9700\u8981 fiber\uff1a</strong></p> <ul> <li>react \u6e32\u67d3\u9700\u8981\u9012\u5f52\u6bd4\u5bf9\u865a\u62df DOM \u6811\uff0c\u627e\u51fa\u9700\u8981\u53d8\u52a8\u7684\u8282\u70b9\uff0c\u7136\u540e\u540c\u6b65\u66f4\u65b0\u5b83\u4eec</li> <li>\u8fd9\u4e2a\u662f\u4e00\u4e2a\u6bd4\u8f83\u8017\u65f6\u7684\u64cd\u4f5c</li> <li>\u4e00\u5219\u4f1a\u5bfc\u81f4\u7528\u6237\u89e6\u53d1\u7684\u4e8b\u4ef6\u5f97\u4e0d\u5230\u54cd\u5e94, \u4e8c\u5219\u4f1a\u5bfc\u81f4\u6389\u5e27\uff0c\u7528\u6237\u53ef\u4ee5\u611f\u77e5\u5230\u8fd9\u4e9b\u5361\u987f</li> </ul> <p><strong>react fiber \u539f\u7406\uff1a</strong></p> <ul> <li><p>fiber \u5c31\u662f\u65f6\u95f4\u5206\u7247</p> </li> <li><p>\u5728\u6d4f\u89c8\u5668\u7684\u4e00\u6b21\u4e8b\u4ef6\u5faa\u73af\u5185(\u4e00\u5e27) (\u5373\u5904\u7406\u7528\u6237\u8f93\u5165\u4e8b\u4ef6\u3001Javascript \u6267\u884c\u3001requestAnimation \u8c03\u7528\u3001\u5e03\u5c40 Layout\u3001\u7ed8\u5236 Paint)</p> </li> <li><p>\u5982\u679c\u6709\u7a7a\u95f2\u65f6\u95f4\uff0c\u5c31\u6267\u884c React \u7684\u4efb\u52a1\u3002react \u4f7f\u7528 requestIdleCallback \u8fd9\u4e2a api \u5b9e\u73b0</p> </li> <li><p>\u800c\u4e14\uff0cReact \u6e32\u67d3\u7684\u8fc7\u7a0b\u53ef\u4ee5\u88ab\u4e2d\u65ad\uff0c\u5982\u679c\u4e00\u5b9a\u65f6\u95f4\u5185\u6ca1\u6709\u6267\u884c\u5b8c\u4efb\u52a1\uff0c\u5c31\u4f1a\u5c06\u63a7\u5236\u6743\u4ea4\u56de\u6d4f\u89c8\u5668\uff0c\u8ba9\u4f4d\u7ed9\u9ad8\u4f18\u5148\u7ea7\u7684\u4efb\u52a1\uff0c\u6d4f\u89c8\u5668\u7a7a\u95f2\u540e\u518d\u6062\u590d\u6e32\u67d3</p> </li> <li><p><code>Fiber</code> \u6811\uff1a<code>React</code> \u5728 <code>render</code> \u7b2c\u4e00\u6b21\u6e32\u67d3\u65f6\uff0c\u4f1a\u901a\u8fc7 <code>React.createElement</code> \u521b\u5efa\u4e00\u9897 <code>Element</code> \u6811\uff0c\u53ef\u4ee5\u79f0\u4e4b\u4e3a <code>Virtual DOM Tree</code>\uff0c\u7531\u4e8e\u8981\u8bb0\u5f55\u4e0a\u4e0b\u6587\u4fe1\u606f\uff0c\u52a0\u5165\u4e86 <code>Fiber</code>\uff0c\u6bcf\u4e00\u4e2a <code>Element</code> \u4f1a\u5bf9\u5e94\u4e00\u4e2a <code>Fiber Node</code>\uff0c\u5c06 <code>Fiber Node</code> \u94fe\u63a5\u8d77\u6765\u7684\u7ed3\u6784\u6210\u4e3a <code>Fiber Tree</code>\u3002<code>Fiber Tree</code> \u4e00\u4e2a\u91cd\u8981\u7684\u7279\u70b9\u662f\u94fe\u8868\u7ed3\u6784\uff0c\u5c06\u9012\u5f52\u904d\u5386\u7f16\u7a0b\u5faa\u73af\u904d\u5386\uff0c\u7136\u540e\u914d\u5408 <code>requestIdleCallback API</code>, \u5b9e\u73b0\u4efb\u52a1\u62c6\u5206\u3001\u4e2d\u65ad\u4e0e\u6062\u590d</p> </li> </ul> <p><strong>react fiber \u4f18\u70b9\uff1a</strong></p> <ul> <li>\u5728\u7a7a\u95f2\u7684\u65f6\u95f4\u6267\u884c React \u6e32\u67d3</li> <li>\u63d0\u9ad8\u7528\u6237\u7684\u54cd\u5e94\u65f6\u95f4\uff0c\u51cf\u5c11\u6389\u5e27</li> </ul> <h3 id="\u9898\u76ee\uff1areact-\u4e3a\u4ec0\u4e48\u9700\u8981-fiber">\u9898\u76ee\uff1areact \u4e3a\u4ec0\u4e48\u9700\u8981 fiber</h3> <h3 id="\u9898\u76ee\uff1areact-fiber-\u6709\u54ea\u4e9b\u4f18\u70b9\uff0c\u600e\u6837\u505a\u5230\u7684">\u9898\u76ee\uff1areact fiber \u6709\u54ea\u4e9b\u4f18\u70b9\uff0c\u600e\u6837\u505a\u5230\u7684</h3> <h2 id="5-\u9ad8\u9636\u7ec4\u4ef6">5 \u9ad8\u9636\u7ec4\u4ef6</h2> <h3 id="51-\u77e5\u8bc6\u70b9">5.1 \u77e5\u8bc6\u70b9</h3> <p><strong>\u4ec0\u4e48\u662f\u9ad8\u9636\u7ec4\u4ef6\uff1a</strong></p> <p>\u9ad8\u9636\u7ec4\u4ef6\u5c31\u662f\u4e00\u4e2a React \u7ec4\u4ef6\u5305\u88f9\u7740\u53e6\u5916\u4e00\u4e2a React \u7ec4\u4ef6\u3002\u7528\u6765\u5b9e\u73b0\u903b\u8f91\u7684\u590d\u7528\u6216\u8005\u5c01\u88c5\u6837\u5f0f\u3001\u5e03\u5c40\uff0c\u7ec4\u4ef6\u7ec4\u5408\u66f4\u7075\u6d3b</p> <p>\u9ad8\u9636\u7ec4\u4ef6\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u88c5\u9970\u5668\uff0c\u8ddf\u88c5\u9970\u5668\u7684\u7406\u5ff5\u662f\u7c7b\u4f3c\u7684</p> <p>HOC \u4e0d\u4f1a\u4fee\u6539\u4f20\u5165\u7684\u7ec4\u4ef6\uff0c\u4e5f\u4e0d\u4f1a\u4f7f\u7528\u7ee7\u627f\u6765\u590d\u5236\u5176\u884c\u4e3a\u3002\u76f8\u53cd\uff0cHOC \u901a\u8fc7\u5c06\u7ec4\u4ef6\u5305\u88c5\u5728\u5bb9\u5668\u7ec4\u4ef6\u4e2d\u6765\u7ec4\u6210\u65b0\u7ec4\u4ef6\u3002HOC \u662f\u7eaf\u51fd\u6570\uff0c\u6ca1\u6709\u526f\u4f5c\u7528</p> <p><strong>\u4f7f\u7528\u573a\u666f\uff1a</strong></p> <p>Redux \u7684 connect\uff0cantd \u7684 form \u7ec4\u4ef6</p> <p><strong>\u9ad8\u9636\u7ec4\u4ef6\u7684\u5199\u6cd5\uff1a</strong></p> <pre><code class="language-js">// \u6b64\u51fd\u6570\u63a5\u6536\u4e00\u4e2a\u7ec4\u4ef6...\nfunction withSubscription(WrappedComponent) {\n  // ...\u5e76\u8fd4\u56de\u53e6\u4e00\u4e2a\u7ec4\u4ef6...\n  return class extends React.Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        str: &#39;this is hoc&#39;\n      };\n    }\n    render() {\n      // ... \u5e76\u4f7f\u7528\u65b0\u6570\u636e\u6e32\u67d3\u88ab\u5305\u88c5\u7684\u7ec4\u4ef6!\n      // \u8bf7\u6ce8\u610f\uff0c\u6211\u4eec\u53ef\u80fd\u8fd8\u4f1a\u4f20\u9012\u5176\u4ed6\u5c5e\u6027\n      return &lt;WrappedComponent str={this.state.str} {...this.props} /&gt;;\n    }\n  };\n}</code></pre> <h3 id="32-\u9898\u76ee\uff1a\u4ec0\u4e48\u662f\u9ad8\u9636\u7ec4\u4ef6\uff0c\u8bf7\u4e3e\u4f8b\u8bf4\u660e">3.2 \u9898\u76ee\uff1a\u4ec0\u4e48\u662f\u9ad8\u9636\u7ec4\u4ef6\uff0c\u8bf7\u4e3e\u4f8b\u8bf4\u660e</h3> <p>\u5982\u4e0a</p> <h2 id="6-\u9519\u8bef\u5904\u7406">6 \u9519\u8bef\u5904\u7406</h2> <h3 id="61-\u77e5\u8bc6\u70b9">6.1 \u77e5\u8bc6\u70b9</h3> <p><strong>\u9519\u8bef\u8fb9\u754c\u7ec4\u4ef6\uff1a</strong></p> <p>\u5982\u679c\u4e00\u4e2a <code>class</code> \u7ec4\u4ef6\u4e2d\u5b9a\u4e49\u4e86 <code>static getDerivedStateFromError()</code> \u6216 <code>componentDidCatch()</code> \u8fd9\u4e24\u4e2a\u751f\u547d\u5468\u671f\u65b9\u6cd5\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\uff08\u6216\u4e24\u4e2a\uff09\u65f6\uff0c\u90a3\u4e48\u5b83\u5c31\u53d8\u6210\u4e00\u4e2a\u9519\u8bef\u8fb9\u754c</p> <p>\u53ef\u4ee5\u6355\u83b7\u5230\u5b50\u7ec4\u4ef6\u7684\u9519\u8bef\uff0c\u5e76\u4e14\u4f60\u53ef\u4ee5\u9009\u62e9\u6e32\u67d3\u4e00\u4e2a\u9519\u8bef UI</p> <p>\u901a\u5e38\u6211\u4eec\u4f1a\u5199\u4e00\u4e2a\u901a\u7528\u7684\u9519\u8bef\u7ec4\u4ef6\u6765\u5904\u7406\u9519\u8bef</p> <pre><code class="language-js">class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // \u66f4\u65b0 state \u4f7f\u4e0b\u4e00\u6b21\u6e32\u67d3\u80fd\u591f\u663e\u793a\u964d\u7ea7\u540e\u7684 UI\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, errorInfo) {\n    // \u4f60\u540c\u6837\u53ef\u4ee5\u5c06\u9519\u8bef\u65e5\u5fd7\u4e0a\u62a5\u7ed9\u670d\u52a1\u5668\n    logErrorToMyService(error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // \u4f60\u53ef\u4ee5\u81ea\u5b9a\u4e49\u964d\u7ea7\u540e\u7684 UI \u5e76\u6e32\u67d3\n      return &lt;h1&gt;Something went wrong.&lt;/h1&gt;;\n    }\n\n    return this.props.children;\n  }\n}</code></pre> <p><strong>\u53ef\u6355\u83b7\u7684\u9519\u8bef\uff1a</strong></p> <ul> <li>\u53ef\u6355\u83b7\u6e32\u67d3\u671f\u95f4\u3001\u751f\u547d\u5468\u671f\u65b9\u6cd5\u548c\u6574\u4e2a\u7ec4\u4ef6\u6811\u7684\u6784\u9020\u51fd\u6570\u4e2d\u7684\u9519\u8bef</li> </ul> <p><strong>\u4e0d\u53ef\u6355\u83b7\u7684\u9519\u8bef\uff1a</strong></p> <ul> <li>\u4e8b\u4ef6\u5904\u7406</li> <li>\u5f02\u6b65\u4ee3\u7801\uff08\u4f8b\u5982 <code>setTimeout</code> \u6216 <code>requestAnimationFrame</code> \u56de\u8c03\u51fd\u6570\uff09</li> <li>\u670d\u52a1\u7aef\u6e32\u67d3</li> <li>\u5b83\u81ea\u8eab\u629b\u51fa\u6765\u7684\u9519\u8bef\uff08\u5e76\u975e\u5b83\u7684\u5b50\u7ec4\u4ef6\uff09</li> </ul> <h3 id="\u9898\u76ee\uff1areact-\u5982\u4f55\u5904\u7406\u5f02\u5e38">\u9898\u76ee\uff1areact \u5982\u4f55\u5904\u7406\u5f02\u5e38</h3> <h2 id="7-\u6027\u80fd\u4f18\u5316">7 \u6027\u80fd\u4f18\u5316</h2> <ul> <li>\u4f7f\u7528 PureComponent\uff0cprops \u548c state \u4ec5\u505a\u6d45\u5c42\u7684\u6bd4\u8f83</li> <li>\u8c28\u614e\u4f7f\u7528 Redux\uff0c\u53ea\u53d6\u9700\u8981\u7684\u503c</li> </ul> <h3 id="\u9898\u76ee\uff1areact-\u6709\u54ea\u4e9b\u6027\u80fd\u4f18\u5316\u7684\u70b9">\u9898\u76ee\uff1areact \u6709\u54ea\u4e9b\u6027\u80fd\u4f18\u5316\u7684\u70b9</h3> <h2 id="8-redux-\u6838\u5fc3\u539f\u5219">8 redux \u6838\u5fc3\u539f\u5219</h2> <h3 id="81-redux-\u4e09\u5927\u539f\u5219">8.1 redux \u4e09\u5927\u539f\u5219</h3> <ol> <li><strong>\u5355\u4e00\u6570\u636e\u6e90</strong> - \u6574\u4e2a\u5e94\u7528\u7684 <code>state</code> \u88ab\u50a8\u5b58\u5728\u4e00\u68f5 <code>object tree</code> \u4e2d\uff0c\u5e76\u4e14\u8fd9\u4e2a <code>object tree</code> \u53ea\u5b58\u5728\u4e8e\u552f\u4e00\u4e00\u4e2a <code>store</code> \u4e2d</li> <li><strong>State \u662f\u53ea\u8bfb\u7684</strong> - \u552f\u4e00\u6539\u53d8 <code>state</code> \u7684\u65b9\u6cd5\u5c31\u662f\u89e6\u53d1 <code>action</code>\uff0c<code>action</code> \u662f\u4e00\u4e2a\u7528\u4e8e\u63cf\u8ff0\u5df2\u53d1\u751f\u4e8b\u4ef6\u7684\u666e\u901a\u5bf9\u8c61</li> <li><strong>\u4f7f\u7528\u7eaf\u51fd\u6570\u6765\u6267\u884c\u4fee\u6539</strong> - \u4e3a\u4e86\u63cf\u8ff0 <code>action</code> \u5982\u4f55\u6539\u53d8 <code>state tree</code>\uff0c\u4f60\u9700\u8981\u7f16\u5199 <code>reducers</code></li> </ol> <pre><code class="language-js">// \u5355\u4e00\u6570\u636e\u6e90\nconsole.log(store.getState());</code></pre> <pre><code class="language-js">// State \u662f\u53ea\u8bfb\u7684\nstore.dispatch({\n  type: &#39;COMPLETE_TODO&#39;,\n  index: 1\n});</code></pre> <h2 id="9-redux-\u6838\u5fc3\u903b\u8f91">9 redux \u6838\u5fc3\u903b\u8f91</h2> <h3 id="91-\u6838\u5fc3\u903b\u8f91">9.1 \u6838\u5fc3\u903b\u8f91</h3> <p><strong>\u9996\u5148\uff0c\u6211\u4eec\u770b\u4e0b\u51e0\u4e2a\u6838\u5fc3\u6982\u5ff5\uff1a</strong></p> <ul> <li><strong>Store\uff1a</strong> \u4fdd\u5b58\u6570\u636e\u7684\u5730\u65b9\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u770b\u6210\u4e00\u4e2a\u5bb9\u5668\uff0c\u6574\u4e2a\u5e94\u7528\u53ea\u80fd\u6709\u4e00\u4e2a Store</li> <li><strong>State\uff1a</strong> Store \u5bf9\u8c61\u5305\u542b\u6240\u6709\u6570\u636e\uff0c\u5982\u679c\u60f3\u5f97\u5230\u67d0\u4e2a\u65f6\u70b9\u7684\u6570\u636e\uff0c\u5c31\u8981\u5bf9 Store \u751f\u6210\u5feb\u7167\uff0c\u8fd9\u79cd\u65f6\u70b9\u7684\u6570\u636e\u96c6\u5408\uff0c\u5c31\u53eb\u505a State</li> <li><strong>Action\uff1a</strong> State \u7684\u53d8\u5316\uff0c\u4f1a\u5bfc\u81f4 View \u7684\u53d8\u5316\u3002\u4f46\u662f\uff0c\u7528\u6237\u63a5\u89e6\u4e0d\u5230 State\uff0c\u53ea\u80fd\u63a5\u89e6\u5230 View\u3002\u6240\u4ee5\uff0cState \u7684\u53d8\u5316\u5fc5\u987b\u662f View \u5bfc\u81f4\u7684\u3002Action \u5c31\u662f View \u53d1\u51fa\u7684\u901a\u77e5\uff0c\u8868\u793a State \u5e94\u8be5\u8981\u53d1\u751f\u53d8\u5316\u4e86\u3002</li> <li><strong>Action Creator\uff1a</strong> View \u8981\u53d1\u9001\u591a\u5c11\u79cd\u6d88\u606f\uff0c\u5c31\u4f1a\u6709\u591a\u5c11\u79cd Action\u3002\u5982\u679c\u90fd\u624b\u5199\uff0c\u4f1a\u5f88\u9ebb\u70e6\uff0c\u6240\u4ee5\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570\u6765\u751f\u6210 Action\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u53eb Action Creator\u3002</li> <li><strong>Reducer\uff1a</strong> Store \u6536\u5230 Action \u4ee5\u540e\uff0c\u5fc5\u987b\u7ed9\u51fa\u4e00\u4e2a\u65b0\u7684 State\uff0c\u8fd9\u6837 View \u624d\u4f1a\u53d1\u751f\u53d8\u5316\u3002\u8fd9\u79cd State \u7684\u8ba1\u7b97\u8fc7\u7a0b\u5c31\u53eb\u505a Reducer\u3002Reducer \u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u5b83\u63a5\u53d7 Action \u548c\u5f53\u524d State \u4f5c\u4e3a\u53c2\u6570\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 State\u3002</li> <li><strong>dispatch\uff1a</strong> \u662f View \u53d1\u51fa Action \u7684\u552f\u4e00\u65b9\u6cd5\u3002</li> </ul> <p><strong>\u7136\u540e\u6211\u4eec\u8fc7\u4e0b\u6574\u4e2a\u5de5\u4f5c\u6d41\u7a0b\uff1a</strong></p> <ol> <li>\u9996\u5148\uff0c\u7528\u6237\uff08\u901a\u8fc7 View\uff09\u53d1\u51fa Action\uff0c\u53d1\u51fa\u65b9\u5f0f\u5c31\u7528\u5230\u4e86 dispatch \u65b9\u6cd5</li> <li>\u7136\u540e\uff0cStore \u81ea\u52a8\u8c03\u7528 Reducer\uff0c\u5e76\u4e14\u4f20\u5165\u4e24\u4e2a\u53c2\u6570\uff1a\u5f53\u524d State \u548c\u6536\u5230\u7684 Action\uff0cReducer \u4f1a\u8fd4\u56de\u65b0\u7684 State</li> <li>State \u4e00\u65e6\u6709\u53d8\u5316\uff0cStore \u5c31\u4f1a\u8c03\u7528\u76d1\u542c\u51fd\u6570\uff0c\u6765\u66f4\u65b0 View</li> </ol> <h3 id="92-demo">9.2 demo</h3> <pre><code class="language-js">import { createStore } from &#39;redux&#39;;\n\nlet defaultState = {\n  name: &#39;qiu&#39;,\n  age: 10\n};\n\n/**\n * \u65b0\u5efastore\n * \u901a\u8fc7reducer\u5efa\u7acb\n * \u6839\u636e\u8001\u7684state\u548caction\u751f\u6210\u65b0\u7684state\n */\nfunction counter(state = defaultState, action) {\n  switch (action.type) {\n    case &#39;addAge&#39;: {\n      state.age = state.age + 1;\n      return state;\n    }\n    case &#39;changeName&#39;:\n      state.name = action.name;\n      return state;\n    default:\n      return state;\n  }\n}\n\nconst store = createStore(counter);\n\n// \u76d1\u542cstore\uff0c\u6bcf\u6b21store\u6539\u53d8\u4f1a\u89e6\u53d1\nstore.subscribe(function() {\n  console.log(store.getState());\n});\n\n// \u6d3e\u53d1\u4e8b\u4ef6\uff0c\u4f20\u9012action\nstore.dispatch({ type: &#39;addAge&#39; });\nstore.dispatch({ type: &#39;addAge&#39; });\nstore.dispatch({\n  type: &#39;changeName&#39;,\n  name: &#39;\u5566\u5566\u5566&#39;\n});</code></pre> <h3 id="\u9898\u76ee\uff1aredux-\u4e2d\u95f4\u4ef6\u673a\u5236">\u9898\u76ee\uff1aredux \u4e2d\u95f4\u4ef6\u673a\u5236</h3> <h2 id="10-\u6570\u636e\u7ed1\u5b9a\u539f\u7406">10 \u6570\u636e\u7ed1\u5b9a\u539f\u7406</h2> <h3 id="101-\u77e5\u8bc6\u70b9">10.1 \u77e5\u8bc6\u70b9</h3> <pre><code class="language-js">```html\n&lt;div id=&quot;app&quot;&gt;\n  &lt;form&gt;\n    &lt;input type=&quot;text&quot; v-model=&quot;number&quot; /&gt;\n    &lt;button type=&quot;button&quot; v-click=&quot;increment&quot;&gt;\u589e\u52a0&lt;/button&gt;\n  &lt;/form&gt;\n  &lt;h3 v-bind=&quot;number&quot;&gt;&lt;/h3&gt;\n  &lt;form&gt;\n    &lt;input type=&quot;text&quot; v-model=&quot;count&quot; /&gt;\n    &lt;button type=&quot;button&quot; v-click=&quot;incre&quot;&gt;\u589e\u52a0&lt;/button&gt;\n  &lt;/form&gt;\n  &lt;h3 v-bind=&quot;count&quot;&gt;&lt;/h3&gt;\n&lt;/div&gt;</code></pre> <pre><code class="language-js">class MyVue {\n  constructor(options) {\n    this._init(options);\n  }\n\n  _init(options) {\n    this.$options = options;\n    this.$el = document.querySelector(options.el);\n    this.$data = options.data;\n    this.$methods = options.methods;\n\n    this._binding = {};\n    this._obverse(this.$data);\n    this._complie(this.$el);\n  }\n\n  _obverse(obj) {\n    var _this = this;\n    Object.keys(obj).forEach(function(key) {\n      if (obj.hasOwnProperty(key)) {\n        _this._binding[key] = {\n          _directives: []\n        };\n        console.log(_this._binding[key]);\n        var value = obj[key];\n        if (typeof value === &#39;object&#39;) {\n          _this._obverse(value);\n        }\n        var binding = _this._binding[key];\n        Object.defineProperty(_this.$data, key, {\n          enumerable: true,\n          configurable: true,\n          get: function() {\n            console.log(`${key}\u83b7\u53d6${value}`);\n            return value;\n          },\n          set: function(newVal) {\n            console.log(`${key}\u66f4\u65b0${newVal}`);\n            if (value !== newVal) {\n              value = newVal;\n              binding._directives.forEach(function(item) {\n                item.update();\n              });\n            }\n          }\n        });\n      }\n    });\n  }\n\n  _complie(root) {\n    var _this = this;\n    var nodes = root.children;\n    for (var i = 0; i &lt; nodes.length; i++) {\n      var node = nodes[i];\n      if (node.children.length) {\n        this._complie(node);\n      }\n\n      if (node.hasAttribute(&#39;v-click&#39;)) {\n        node.onclick = (function() {\n          var attrVal = nodes[i].getAttribute(&#39;v-click&#39;);\n          return _this.$methods[attrVal].bind(_this.$data);\n        })();\n      }\n\n      if (node.hasAttribute(&#39;v-model&#39;) &amp;&amp; (node.tagName === &#39;INPUT&#39; || node.tagName === &#39;TEXTAREA&#39;)) {\n        node.addEventListener(\n          &#39;input&#39;,\n          (function(key) {\n            var attrVal = node.getAttribute(&#39;v-model&#39;);\n            _this._binding[attrVal]._directives.push(new Watcher(&#39;input&#39;, node, _this, attrVal, &#39;value&#39;));\n\n            return function() {\n              _this.$data[attrVal] = nodes[key].value;\n            };\n          })(i)\n        );\n      }\n\n      if (node.hasAttribute(&#39;v-bind&#39;)) {\n        var attrVal = node.getAttribute(&#39;v-bind&#39;);\n        _this._binding[attrVal]._directives.push(new Watcher(&#39;text&#39;, node, _this, attrVal, &#39;innerHTML&#39;));\n      }\n    }\n  }\n}\n\nclass Watcher {\n  constructor(name, el, vm, exp, attr) {\n    this.name = name; //\u6307\u4ee4\u540d\u79f0\uff0c\u4f8b\u5982\u6587\u672c\u8282\u70b9\uff0c\u8be5\u503c\u8bbe\u4e3a&quot;text&quot;\n    this.el = el; //\u6307\u4ee4\u5bf9\u5e94\u7684DOM\u5143\u7d20\n    this.vm = vm; //\u6307\u4ee4\u6240\u5c5emyVue\u5b9e\u4f8b\n    this.exp = exp; //\u6307\u4ee4\u5bf9\u5e94\u7684\u503c\uff0c\u672c\u4f8b\u5982&quot;number&quot;\n    this.attr = attr; //\u7ed1\u5b9a\u7684\u5c5e\u6027\u503c\uff0c\u672c\u4f8b\u4e3a&quot;innerHTML&quot;\n\n    this.update();\n  }\n\n  // \u66f4\u65b0 html \u4e2d\u7684\u503c\n  update() {\n    this.el[this.attr] = this.vm.$data[this.exp];\n  }\n}\n\nwindow.onload = function() {\n  var app = new MyVue({\n    el: &#39;#app&#39;,\n\n    data: {\n      number: 0,\n      count: 0\n    },\n\n    methods: {\n      increment: function() {\n        this.number++;\n      },\n\n      incre: function() {\n        this.count++;\n      }\n    }\n  });\n};</code></pre> <h3 id="\u9898\u76ee\uff1avue-\u7684\u6570\u636e\u7ed1\u5b9a\u673a\u5236\u662f\u5982\u4f55\u5b9e\u73b0\u7684">\u9898\u76ee\uff1avue \u7684\u6570\u636e\u7ed1\u5b9a\u673a\u5236\u662f\u5982\u4f55\u5b9e\u73b0\u7684</h3> <p>\u4f7f\u7528 getter setter \u8fdb\u884c\u6570\u636e\u52ab\u6301\uff0c\u548c\u89c2\u5bdf\u8005\u6a21\u5f0f\u5b9e\u73b0\u7684</p> <h2 id="11-computed-\u548c-watch">11 computed \u548c watch</h2> <h3 id="111-\u77e5\u8bc6\u70b9">11.1 \u77e5\u8bc6\u70b9</h3> <ul> <li>\u4ed6\u4eec\u4e24\u8005\u90fd\u662f\u89c2\u5bdf\u9875\u9762\u6570\u636e\u53d8\u5316\u7684</li> <li><strong>computed\uff1a</strong> \u5f53\u4f9d\u8d56\u7684\u6570\u636e\u53d1\u9001\u53d8\u5316\u65f6\uff0c\u4f1a\u6267\u884c\u65b9\u6cd5\uff0c\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684\u6570\u636e</li> <li><strong>watch\uff1a</strong> watch \u662f\u76d1\u542c\u6570\u636e\u7684\u53d8\u5316\uff0c\u89e6\u53d1\u64cd\u4f5c</li> </ul> <pre><code class="language-js">var vm = new Vue({\n  el: &#39;#example&#39;,\n  data: {\n    message: &#39;Hello&#39;\n  },\n  computed: {\n    // \u8ba1\u7b97\u5c5e\u6027\u7684 getter\n    reversedMessage: function() {\n      // `this` \u6307\u5411 vm \u5b9e\u4f8b\n      return this.message\n        .split(&#39;&#39;)\n        .reverse()\n        .join(&#39;&#39;);\n    }\n  }\n});</code></pre> <p><code>computed</code> \u91cc\u9762\u63d0\u4f9b\u7684\u65b9\u6cd5\u5c06\u7528\u4f5c <code>property</code> <code>vm.reversedMessage</code> \u7684 <code>getter</code> \u51fd\u6570</p> <h3 id="\u9898\u76ee\uff1avue-\u7684-computed-\u548c-watch-\u7684\u533a\u522b">\u9898\u76ee\uff1avue \u7684 computed \u548c watch \u7684\u533a\u522b</h3> <h2 id="12-slot">12 slot</h2> <h2 id="13-next-tick-\u539f\u7406">13 next tick \u539f\u7406</h2> <h3 id="131-\u77e5\u8bc6\u70b9">13.1 \u77e5\u8bc6\u70b9</h3> <p><strong>\u4ec0\u4e48\u662f next tick\uff1a</strong></p> <p>\u5728\u4e0b\u6b21 DOM \u66f4\u65b0\u5faa\u73af\u7ed3\u675f\u4e4b\u540e\u6267\u884c\u5ef6\u8fdf\u56de\u8c03</p> <pre><code class="language-js">export default {\n  methods: {\n    setData() {\n      this.msg = &#39;Hello&#39;;\n      this.$nextTick(function() {\n        // DOM \u66f4\u65b0\u4e86\n      });\n    }\n  }\n};</code></pre> <p><strong>next tick \u539f\u7406\uff1a</strong></p> <ul> <li><code>Vue</code> \u5728\u66f4\u65b0 <code>DOM</code> \u65f6\u662f\u5f02\u6b65\u6267\u884c\u7684</li> <li>\u53ea\u8981\u4fa6\u542c\u5230\u6570\u636e\u53d8\u5316\uff0c<code>Vue</code> \u5c06\u5f00\u542f\u4e00\u4e2a\u961f\u5217\uff0c\u5e76\u7f13\u51b2\u5728\u540c\u4e00\u4e8b\u4ef6\u5faa\u73af\u4e2d\u53d1\u751f\u7684\u6240\u6709\u6570\u636e\u53d8\u66f4</li> <li>\u5982\u679c\u540c\u4e00\u4e2a <code>watcher</code> \u88ab\u591a\u6b21\u89e6\u53d1\uff0c\u53ea\u4f1a\u88ab\u63a8\u5165\u5230\u961f\u5217\u4e2d\u4e00\u6b21 (\u540c\u6b65\u7684\u4ee3\u7801\u4e2d)</li> <li><code>Vue</code> \u5728\u5185\u90e8\u5bf9\u5f02\u6b65\u961f\u5217\u5c1d\u8bd5\u4f7f\u7528\u539f\u751f\u7684 <code>Promise.then</code>\u3001<code>MutationObserver</code> \u548c <code>setImmediate</code>\uff0c\u5982\u679c\u6267\u884c\u73af\u5883\u4e0d\u652f\u6301\uff0c\u5219\u4f1a\u91c7\u7528 <code>setTimeout(fn, 0)</code> \u4ee3\u66ff</li> </ul> <h3 id="\u9898\u76ee\uff1avue-nexttick-\u5b9e\u73b0\u539f\u7406">\u9898\u76ee\uff1a<code>vue $nextTick</code> \u5b9e\u73b0\u539f\u7406</h3> <h2 id="14-keep-alive">14 keep alive</h2> <h3 id="\u9898\u76ee\uff1a\u8bf4\u4e0b-vue-\u7684-keep-alive">\u9898\u76ee\uff1a\u8bf4\u4e0b vue \u7684 keep alive</h3> <h2 id="15-vue-\u751f\u547d\u5468\u671f">15 vue \u751f\u547d\u5468\u671f</h2> <p><img src="'+g+'" alt=""></p> <h2 id="16-react-\u751f\u547d\u5468\u671f">16 react \u751f\u547d\u5468\u671f</h2> <p><img src="'+m+'" alt=""></p> ';e.exports=v}}]);