(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["docs/sequelize/instances"],{"9TX5":function(e,n){var t='<h1 id="instances---\u5b9e\u4f8b">Instances - \u5b9e\u4f8b</h1> <h2 id="\u6784\u5efa\u975e\u6301\u4e45\u6027\u5b9e\u4f8b">\u6784\u5efa\u975e\u6301\u4e45\u6027\u5b9e\u4f8b</h2> <p>\u4e3a\u4e86\u521b\u5efa\u5b9a\u4e49\u7c7b\u7684\u5b9e\u4f8b\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u3002 \u5982\u679c\u4f60\u4ee5\u524d\u7f16\u5199\u8fc7 Ruby\uff0c\u4f60\u53ef\u80fd\u8ba4\u8bc6\u8be5\u8bed\u6cd5\u3002 \u4f7f\u7528 <code>build</code> - \u8be5\u65b9\u6cd5\u5c06\u8fd4\u56de\u4e00\u4e2a\u672a\u4fdd\u5b58\u7684\u5bf9\u8c61\uff0c\u4f60\u8981\u660e\u786e\u5730\u4fdd\u5b58\u5b83\u3002</p> <pre><code class="language-js">const project = Project.build({\n  title: &#39;my awesome project&#39;,\n  description: &#39;woot woot. this will make me a rich man&#39;\n})\n\nconst task = Task.build({\n  title: &#39;specify the project idea&#39;,\n  description: &#39;bla&#39;,\n  deadline: new Date()\n})</code></pre> <p>\u5185\u7f6e\u5b9e\u4f8b\u5728\u5b9a\u4e49\u65f6\u4f1a\u81ea\u52a8\u83b7\u53d6\u9ed8\u8ba4\u503c\uff1a</p> <pre><code class="language-js">// \u9996\u5148\u5b9a\u4e49\u6a21\u578b\nconst Task = sequelize.define(&#39;task&#39;, {\n  title: Sequelize.STRING,\n  rating: { type: Sequelize.STRING, defaultValue: 3 }\n})\n\n// \u73b0\u5728\u5b9e\u4f8b\u5316\u4e00\u4e2a\u5bf9\u8c61\nconst task = Task.build({title: &#39;very important task&#39;})\n\ntask.title  // ==&gt; &#39;very important task&#39;\ntask.rating // ==&gt; 3</code></pre> <p>\u8981\u5c06\u5176\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u8bf7\u4f7f\u7528 <code>save</code> \u65b9\u6cd5\u5e76\u6355\u83b7\u4e8b\u4ef6(\u5982\u679c\u9700\u8981):</p> <pre><code class="language-js">project.save().then(() =&gt; {\n  // \u56de\u8c03\n})\n\ntask.save().catch(error =&gt; {\n  // \u5443\n})\n\n// \u8fd8\u53ef\u4ee5\u4f7f\u7528\u94fe\u5f0f\u6784\u5efa\u6765\u4fdd\u5b58\u548c\u8bbf\u95ee\u5bf9\u8c61\uff1a\nTask\n  .build({ title: &#39;foo&#39;, description: &#39;bar&#39;, deadline: new Date() })\n  .save()\n  .then(anotherTask =&gt; {\n    // \u60a8\u73b0\u5728\u53ef\u4ee5\u4f7f\u7528\u53d8\u91cf anotherTask \u8bbf\u95ee\u5f53\u524d\u4fdd\u5b58\u7684\u4efb\u52a1\n  })\n  .catch(error =&gt; {\n    // Ooops\uff0c\u505a\u4e00\u4e9b\u9519\u8bef\u5904\u7406\n  })</code></pre> <h2 id="\u521b\u5efa\u6301\u4e45\u6027\u5b9e\u4f8b">\u521b\u5efa\u6301\u4e45\u6027\u5b9e\u4f8b</h2> <p>\u9664\u4e86\u6784\u5efa\u5bf9\u8c61\u4e4b\u5916\uff0c\u8fd8\u9700\u8981\u4e00\u4e2a\u660e\u786e\u7684\u4fdd\u5b58\u8c03\u7528\u6765\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u6240\u6709\u8fd9\u4e9b\u6b65\u9aa4\u3002 \u5b83\u88ab\u79f0\u4e3a <code>create</code>\u3002</p> <pre><code class="language-js">Task.create({ title: &#39;foo&#39;, description: &#39;bar&#39;, deadline: new Date() }).then(task =&gt; {\n  // \u4f60\u73b0\u5728\u53ef\u4ee5\u901a\u8fc7\u53d8\u91cf task \u6765\u8bbf\u95ee\u65b0\u521b\u5efa\u7684 task\n})</code></pre> <p>\u4e5f\u53ef\u4ee5\u901a\u8fc7 <code>create</code> \u65b9\u6cd5\u5b9a\u4e49\u54ea\u4e9b\u5c5e\u6027\u53ef\u4ee5\u8bbe\u7f6e\u3002 \u5982\u679c\u4f60\u521b\u5efa\u57fa\u4e8e\u53ef\u7531\u7528\u6237\u586b\u5199\u7684\u8868\u5355\u7684\u6570\u636e\u5e93\u6761\u76ee\uff0c\u8fd9\u5c06\u975e\u5e38\u65b9\u4fbf\u3002 \u4f8b\u5982\uff0c\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u4f60\u53ef\u4ee5\u9650\u5236 <code>User</code> \u6a21\u578b\uff0c\u4ec5\u8bbe\u7f6e username \u548c address\uff0c\u800c\u4e0d\u662f admin \u6807\u5fd7\uff1a</p> <pre><code class="language-js">User.create({ username: &#39;barfooz&#39;, isAdmin: true }, { fields: [ &#39;username&#39; ] }).then(user =&gt; {\n  // \u6211\u4eec\u5047\u8bbe isAdmin \u7684\u9ed8\u8ba4\u503c\u4e3a false\uff1a\n  console.log(user.get({\n    plain: true\n  })) // =&gt; { username: &#39;barfooz&#39;, isAdmin: false }\n})</code></pre> <h2 id="\u66f4\u65b0--\u4fdd\u5b58--\u6301\u4e45\u5316\u4e00\u4e2a\u5b9e\u4f8b">\u66f4\u65b0 / \u4fdd\u5b58 / \u6301\u4e45\u5316\u4e00\u4e2a\u5b9e\u4f8b</h2> <p>\u73b0\u5728\u53ef\u4ee5\u66f4\u6539\u4e00\u4e9b\u503c\u5e76\u5c06\u66f4\u6539\u4fdd\u5b58\u5230\u6570\u636e\u5e93...\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b9e\u73b0\uff1a</p> <pre><code class="language-js">// \u65b9\u6cd5 1\ntask.title = &#39;a very different title now&#39;\ntask.save().then(() =&gt; {})\n\n// \u65b9\u6cd5 2\ntask.update({\n  title: &#39;a very different title now&#39;\n}).then(() =&gt; {})</code></pre> <p>\u901a\u8fc7\u4f20\u9012\u5217\u540d\u6570\u7ec4\uff0c\u8c03\u7528 <code>save</code> \u65f6\u4e5f\u53ef\u4ee5\u5b9a\u4e49\u54ea\u4e9b\u5c5e\u6027\u5e94\u8be5\u88ab\u4fdd\u5b58\u3002 \u5f53\u60a8\u57fa\u4e8e\u5148\u524d\u5b9a\u4e49\u7684\u5bf9\u8c61\u8bbe\u7f6e\u5c5e\u6027\u65f6\uff0c\u8fd9\u662f\u6709\u7528\u7684\u3002 \u4f8b\u5982\u3002 \u5982\u679c\u60a8\u901a\u8fc7Web\u5e94\u7528\u7a0b\u5e8f\u7684\u5f62\u5f0f\u83b7\u53d6\u5bf9\u8c61\u7684\u503c\u3002 \u6b64\u5916\uff0c\u8fd9\u5728 <code>update</code> \u5185\u90e8\u4f7f\u7528\u3002 \u5b83\u5c31\u50cf\u8fd9\u6837\uff1a</p> <pre><code class="language-js">task.title = &#39;foooo&#39;\ntask.description = &#39;baaaaaar&#39;\ntask.save({fields: [&#39;title&#39;]}).then(() =&gt; {\n // title \u73b0\u5728\u5c06\u662f \u201cfoooo\u201d\uff0c\u800c description \u4e0e\u4ee5\u524d\u4e00\u6837\n})\n\n// \u4f7f\u7528\u7b49\u6548\u7684 update \u8c03\u7528\u5982\u4e0b\u6240\u793a:\ntask.update({ title: &#39;foooo&#39;, description: &#39;baaaaaar&#39;}, {fields: [&#39;title&#39;]}).then(() =&gt; {\n //  title \u73b0\u5728\u5c06\u662f \u201cfoooo\u201d\uff0c\u800c description \u4e0e\u4ee5\u524d\u4e00\u6837\n})</code></pre> <p>\u5f53\u4f60\u8c03\u7528 <code>save</code>\u800c\u4e0d\u6539\u53d8\u4efb\u4f55\u5c5e\u6027\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4ec0\u4e48\u90fd\u4e0d\u6267\u884c\u3002 </p> <h2 id="\u9500\u6bc1--\u5220\u9664\u6301\u4e45\u6027\u5b9e\u4f8b">\u9500\u6bc1 / \u5220\u9664\u6301\u4e45\u6027\u5b9e\u4f8b</h2> <p>\u521b\u5efa\u5bf9\u8c61\u5e76\u83b7\u5f97\u5bf9\u8c61\u7684\u5f15\u7528\u540e\uff0c\u53ef\u4ee5\u4ece\u6570\u636e\u5e93\u4e2d\u5220\u9664\u5b83\u3002 \u76f8\u5173\u7684\u65b9\u6cd5\u662f <code>destroy</code>\uff1a</p> <pre><code class="language-js">Task.create({ title: &#39;a task&#39; }).then(task =&gt; {\n  // \u83b7\u53d6\u5230 task \u5bf9\u8c61...\n  return task.destroy();\n}).then(() =&gt; {\n // task \u5bf9\u8c61\u5df2\u88ab\u9500\u6bc1\n})</code></pre> <p>\u5982\u679c <code>paranoid</code> \u9009\u9879\u4e3a true\uff0c\u5219\u4e0d\u4f1a\u5220\u9664\u8be5\u5bf9\u8c61\uff0c\u800c\u5c06 <code>deletedAt</code> \u5217\u8bbe\u7f6e\u4e3a\u5f53\u524d\u65f6\u95f4\u6233\u3002 \u8981\u5f3a\u5236\u5220\u9664\uff0c\u53ef\u4ee5\u5c06 <code>force: true</code> \u4f20\u9012\u7ed9 destroy \u8c03\u7528\uff1a</p> <pre><code class="language-js">task.destroy({ force: true })</code></pre> <h2 id="\u6279\u91cf\u64cd\u4f5c\uff08\u4e00\u6b21\u521b\u5efa\uff0c\u66f4\u65b0\u548c\u9500\u6bc1\u591a\u884c\uff09">\u6279\u91cf\u64cd\u4f5c\uff08\u4e00\u6b21\u521b\u5efa\uff0c\u66f4\u65b0\u548c\u9500\u6bc1\u591a\u884c\uff09</h2> <p>\u9664\u4e86\u66f4\u65b0\u5355\u4e2a\u5b9e\u4f8b\u4e4b\u5916\uff0c\u4f60\u8fd8\u53ef\u4ee5\u4e00\u6b21\u521b\u5efa\uff0c\u66f4\u65b0\u548c\u5220\u9664\u591a\u4e2a\u5b9e\u4f8b\u3002 \u8c03\u7528\u4f60\u9700\u8981\u7684\u65b9\u6cd5</p> <ul> <li><code>Model.bulkCreate</code></li> <li><code>Model.update</code></li> <li><code>Model.destroy</code></li> </ul> <p>\u7531\u4e8e\u4f60\u4f7f\u7528\u591a\u4e2a\u6a21\u578b\uff0c\u56de\u8c03\u5c06\u4e0d\u4f1a\u8fd4\u56deDAO\u5b9e\u4f8b\u3002 BulkCreate\u5c06\u8fd4\u56de\u4e00\u4e2a\u6a21\u578b\u5b9e\u4f8b/DAO\u7684\u6570\u7ec4\uff0c\u4f46\u662f\u5b83\u4eec\u4e0d\u540c\u4e8e<code>create</code>\uff0c\u6ca1\u6709 autoIncrement \u5c5e\u6027\u7684\u7ed3\u679c\u503c. <code>update</code> \u548c <code>destroy</code> \u5c06\u8fd4\u56de\u53d7\u5f71\u54cd\u7684\u884c\u6570\u3002</p> <p>\u9996\u5148\u770b\u4e0b bulkCreate</p> <pre><code class="language-js">User.bulkCreate([\n  { username: &#39;barfooz&#39;, isAdmin: true },\n  { username: &#39;foo&#39;, isAdmin: true },\n  { username: &#39;bar&#39;, isAdmin: false }\n]).then(() =&gt; { // \u6ce8\u610f: \u8fd9\u91cc\u6ca1\u6709\u51ed\u636e, \u7136\u800c\u73b0\u5728\u4f60\u9700\u8981...\n  return User.findAll();\n}).then(users =&gt; {\n  console.log(users) // ... \u4ee5\u83b7\u53d6 user \u5bf9\u8c61\u7684\u6570\u7ec4\n})</code></pre> <p>\u4e00\u6b21\u66f4\u65b0\u51e0\u884c:</p> <pre><code class="language-js">Task.bulkCreate([\n  {subject: &#39;programming&#39;, status: &#39;executing&#39;},\n  {subject: &#39;reading&#39;, status: &#39;executing&#39;},\n  {subject: &#39;programming&#39;, status: &#39;finished&#39;}\n]).then(() =&gt; {\n  return Task.update(\n    { status: &#39;inactive&#39; }, /* \u8bbe\u7f6e\u5c5e\u6027\u7684\u503c */,\n    { where: { subject: &#39;programming&#39; }} /* where \u89c4\u5219 */\n  );\n}).spread((affectedCount, affectedRows) =&gt; {\n  // .update \u5728\u6570\u7ec4\u4e2d\u8fd4\u56de\u4e24\u4e2a\u503c\uff0c\u56e0\u6b64\u6211\u4eec\u4f7f\u7528 .spread\n  // \u8bf7\u6ce8\u610f\uff0caffectedRows \u53ea\u652f\u6301\u4ee5 returning: true \u7684\u65b9\u5f0f\u8fdb\u884c\u5b9a\u4e49\n\n  // affectedCount \u5c06\u4f1a\u662f 2\n  return Task.findAll();\n}).then(tasks =&gt; {\n  console.log(tasks) // \u201cprogramming\u201d \u4efb\u52a1\u90fd\u5c06\u5904\u4e8e \u201cinactive\u201d \u72b6\u6001\n})</code></pre> <p>\u7136\u540e\u5220\u9664\u5b83\u4eec:</p> <pre><code class="language-js">Task.bulkCreate([\n  {subject: &#39;programming&#39;, status: &#39;executing&#39;},\n  {subject: &#39;reading&#39;, status: &#39;executing&#39;},\n  {subject: &#39;programming&#39;, status: &#39;finished&#39;}\n]).then(() =&gt; {\n  return Task.destroy({\n    where: {\n      subject: &#39;programming&#39;\n    },\n    truncate: true /* \u8fd9\u5c06\u5ffd where \u5e76\u7528 truncate table \u66ff\u4ee3  */\n  });\n}).then(affectedRows =&gt; {\n  // affectedRows \u5c06\u4f1a\u662f 2\n  return Task.findAll();\n}).then(tasks =&gt; {\n  console.log(tasks) // \u663e\u793a tasks \u5185\u5bb9\n})</code></pre> <p>\u5982\u679c\u60a8\u76f4\u63a5\u4ece user \u63a5\u53d7\u503c\uff0c\u5219\u9650\u5236\u8981\u5b9e\u9645\u63d2\u5165\u7684\u5217\u53ef\u80fd\u4f1a\u66f4\u597d\u3002<code>bulkCreate()</code> \u63a5\u53d7\u4e00\u4e2a\u9009\u9879\u5bf9\u8c61\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002 \u8be5\u5bf9\u8c61\u53ef\u4ee5\u6709\u4e00\u4e2a <code>fields</code> \u53c2\u6570\uff08\u4e00\u4e2a\u6570\u7ec4\uff09\uff0c\u8ba9\u5b83\u77e5\u9053\u4f60\u60f3\u8981\u660e\u786e\u6784\u5efa\u54ea\u4e9b\u5b57\u6bb5</p> <pre><code class="language-js">User.bulkCreate([\n  { username: &#39;foo&#39; },\n  { username: &#39;bar&#39;, admin: true}\n], { fields: [&#39;username&#39;] }).then(() =&gt; {\n  // admin \u5c06\u4e0d\u4f1a\u88ab\u6784\u5efa\n})</code></pre> <p><code>bulkCreate</code> \u6700\u521d\u662f\u6210\u4e3a \u4e3b\u6d41/\u5feb\u901f \u63d2\u5165\u8bb0\u5f55\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u6709\u65f6\u60a8\u5e0c\u671b\u80fd\u591f\u540c\u65f6\u63d2\u5165\u591a\u884c\u800c\u4e0d\u727a\u7272\u6a21\u578b\u9a8c\u8bc1\uff0c\u5373\u4f7f\u60a8\u660e\u786e\u5730\u544a\u8bc9 Sequelize \u53bb\u7b5b\u9009\u54ea\u4e9b\u5217\u3002 \u4f60\u53ef\u4ee5\u901a\u8fc7\u5728options\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u4e00\u4e2a <code>validate: true</code> \u5c5e\u6027\u6765\u5b9e\u73b0\u3002</p> <pre><code class="language-js">const Tasks = sequelize.define(&#39;task&#39;, {\n  name: {\n    type: Sequelize.STRING,\n    validate: {\n      notNull: { args: true, msg: &#39;name cannot be null&#39; }\n    }\n  },\n  code: {\n    type: Sequelize.STRING,\n    validate: {\n      len: [3, 10]\n    }\n  }\n})\n\nTasks.bulkCreate([\n  {name: &#39;foo&#39;, code: &#39;123&#39;},\n  {code: &#39;1234&#39;},\n  {name: &#39;bar&#39;, code: &#39;1&#39;}\n], { validate: true }).catch(errors =&gt; {\n\n  /* console.log(errors) \u770b\u8d77\u6765\u50cf\u8fd9\u6837:\n  [\n    { record:\n    ...\n    errors:\n      { name: &#39;SequelizeValidationError&#39;,\n        message: &#39;Validation error&#39;,\n        errors: [Object] } },\n    { record:\n      ...\n      errors:\n        { name: &#39;SequelizeValidationError&#39;,\n        message: &#39;Validation error&#39;,\n        errors: [Object] } }\n  ]\n  */\n\n})</code></pre> <h2 id="\u4e00\u4e2a\u5b9e\u4f8b\u7684\u503c">\u4e00\u4e2a\u5b9e\u4f8b\u7684\u503c</h2> <p>\u5982\u679c\u4f60\u8bb0\u5f55\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u4f60\u4f1a\u6ce8\u610f\u5230\u6709\u5f88\u591a\u989d\u5916\u7684\u4e1c\u897f\u3002 \u4e3a\u4e86\u9690\u85cf\u8fd9\u4e9b\u4e1c\u897f\u5e76\u5c06\u5176\u51cf\u5c11\u5230\u975e\u5e38\u6709\u8da3\u7684\u4fe1\u606f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>get</code> \u5c5e\u6027\u3002 \u4f7f\u7528\u9009\u9879 <code>plain: true</code> \u8c03\u7528\u5b83\u5c06\u53ea\u8fd4\u56de\u4e00\u4e2a\u5b9e\u4f8b\u7684\u503c\u3002</p> <pre><code class="language-js">Person.create({\n  name: &#39;Rambow&#39;,\n  firstname: &#39;John&#39;\n}).then(john =&gt; {\n  console.log(john.get({\n    plain: true\n  }))\n})\n\n// \u7ed3\u679c:\n\n// { name: &#39;Rambow&#39;,\n//   firstname: &#39;John&#39;,\n//   id: 1,\n//   createdAt: Tue, 01 May 2012 19:12:16 GMT,\n//   updatedAt: Tue, 01 May 2012 19:12:16 GMT\n// }</code></pre> <p><strong>\u63d0\u793a:</strong> \u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 <code>JSON.stringify(instance)</code> \u5c06\u4e00\u4e2a\u5b9e\u4f8b\u8f6c\u6362\u4e3a JSON\u3002 \u57fa\u672c\u4e0a\u4e0e <code>values</code> \u8fd4\u56de\u7684\u76f8\u540c\u3002</p> <h2 id="\u91cd\u8f7d\u5b9e\u4f8b">\u91cd\u8f7d\u5b9e\u4f8b</h2> <p>\u5982\u679c\u4f60\u9700\u8981\u8ba9\u4f60\u7684\u5b9e\u4f8b\u540c\u6b65\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>reload</code> \u65b9\u6cd5\u3002 \u5b83\u5c06\u4ece\u6570\u636e\u5e93\u4e2d\u83b7\u53d6\u5f53\u524d\u6570\u636e\uff0c\u5e76\u8986\u76d6\u8c03\u7528\u8be5\u65b9\u6cd5\u7684\u6a21\u578b\u7684\u5c5e\u6027\u3002</p> <pre><code class="language-js">Person.findOne({ where: { name: &#39;john&#39; } }).then(person =&gt; {\n  person.name = &#39;jane&#39;\n  console.log(person.name) // &#39;jane&#39;\n\n  person.reload().then(() =&gt; {\n    console.log(person.name) // &#39;john&#39;\n  })\n})</code></pre> <h2 id="\u9012\u589e">\u9012\u589e</h2> <p>\u4e3a\u4e86\u589e\u52a0\u5b9e\u4f8b\u7684\u503c\u800c\u4e0d\u53d1\u751f\u5e76\u53d1\u95ee\u9898\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>increment</code>\u3002</p> <p>\u9996\u5148\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5b57\u6bb5\u548c\u8981\u6dfb\u52a0\u7684\u503c\u3002</p> <pre><code class="language-js">User.findById(1).then(user =&gt; {\n  return user.increment(&#39;my-integer-field&#39;, {by: 2})\n}).then(user =&gt; {\n  // Postgres\u9ed8\u8ba4\u4f1a\u8fd4\u56de\u66f4\u65b0\u7684 user (\u9664\u975e\u901a\u8fc7\u8bbe\u7f6e\u7981\u7528 { returning: false })\n  // \u5728\u5176\u4ed6\u65b9\u8a00\u4e2d\uff0c\u60a8\u5c06\u9700\u8981\u8c03\u7528 user.reload() \u6765\u83b7\u53d6\u66f4\u65b0\u7684\u5b9e\u4f8b...\n})</code></pre> <p>\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a\u5b57\u6bb5\u548c\u8981\u6dfb\u52a0\u5230\u5176\u4e2d\u7684\u503c\u3002</p> <pre><code class="language-js">User.findById(1).then(user =&gt; {\n  return user.increment([ &#39;my-integer-field&#39;, &#39;my-very-other-field&#39; ], {by: 2})\n}).then(/* ... */)</code></pre> <p>\u6700\u540e\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5305\u542b\u5b57\u6bb5\u53ca\u5176\u9012\u589e\u503c\u7684\u5bf9\u8c61\u3002</p> <pre><code class="language-js">User.findById(1).then(user =&gt; {\n  return user.increment({\n    &#39;my-integer-field&#39;:    2,\n    &#39;my-very-other-field&#39;: 3\n  })\n}).then(/* ... */)</code></pre> <h2 id="\u9012\u51cf">\u9012\u51cf</h2> <p>\u4e3a\u4e86\u51cf\u5c11\u4e00\u4e2a\u5b9e\u4f8b\u7684\u503c\u800c\u4e0d\u9047\u5230\u5e76\u53d1\u95ee\u9898\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 <code>decrement</code>\u3002</p> <p>\u9996\u5148\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5b57\u6bb5\u548c\u8981\u6dfb\u52a0\u7684\u503c\u3002</p> <pre><code class="language-js">User.findById(1).then(user =&gt; {\n  return user.decrement(&#39;my-integer-field&#39;, {by: 2})\n}).then(user =&gt; {\n  // Postgres\u9ed8\u8ba4\u4f1a\u8fd4\u56de\u66f4\u65b0\u7684 user (\u9664\u975e\u901a\u8fc7\u8bbe\u7f6e\u7981\u7528 { returning: false })\n  // \u5728\u5176\u4ed6\u65b9\u8a00\u4e2d\uff0c\u60a8\u5c06\u9700\u8981\u8c03\u7528 user.reload() \u6765\u83b7\u53d6\u66f4\u65b0\u7684\u5b9e\u4f8b...\n})</code></pre> <p>\u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a\u5b57\u6bb5\u548c\u8981\u6dfb\u52a0\u5230\u5176\u4e2d\u7684\u503c\u3002</p> <pre><code class="language-js">User.findById(1).then(user =&gt; {\n  return user.decrement([ &#39;my-integer-field&#39;, &#39;my-very-other-field&#39; ], {by: 2})\n}).then(/* ... */)</code></pre> <p>\u6700\u540e\uff0c \u4f60\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5305\u542b\u5b57\u6bb5\u53ca\u5176\u9012\u51cf\u503c\u7684\u5bf9\u8c61\u3002</p> <pre><code class="language-js">User.findById(1).then(user =&gt; {\n  return user.decrement({\n    &#39;my-integer-field&#39;:    2,\n    &#39;my-very-other-field&#39;: 3\n  })\n}).then(/* ... */)</code></pre> ';e.exports=t}}]);