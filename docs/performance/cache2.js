(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["docs/performance/cache2"],{wZtv:function(t,e,i){var a=i("Rxnk"),p=i("aWNz"),d=i("LmYT"),o=i("2OB8"),l=i("i19P"),h=i("ctBy"),r=i("Mpxs"),c=i("YvTT"),s=a(p),n=a(d),f=a(o),u=a(l),g=a(h),M=a(r),m=a(c),y='<h1 id="\u6d4f\u89c8\u5668\u7f13\u5b58http-\u7f13\u5b58">\u6d4f\u89c8\u5668\u7f13\u5b58(http \u7f13\u5b58)</h1> <p>\u6d4f\u89c8\u5668\u7f13\u5b58\u5176\u5b9e\u5c31\u662f\u6d4f\u89c8\u5668\u4fdd\u5b58\u901a\u8fc7 HTTP \u83b7\u53d6\u7684\u6240\u6709\u8d44\u6e90,\u662f\u6d4f\u89c8\u5668\u5c06\u7f51\u7edc\u8d44\u6e90\u5b58\u50a8\u5728\u672c\u5730\u7684\u4e00\u79cd\u884c\u4e3a\u3002</p> <p><img src="'+s+'" alt=""></p> <h2 id="1-\u7f13\u5b58\u5b58\u50a8\u7684\u4f4d\u7f6e">1 \u7f13\u5b58\u5b58\u50a8\u7684\u4f4d\u7f6e</h2> <ul> <li>memory cache \u5c06\u8d44\u6e90\u7f13\u5b58\u5230\u5185\u5b58\u4e2d\uff0c\u7b49\u5f85\u4e0b\u6b21\u8bbf\u95ee\u65f6\u4e0d\u9700\u8981\u91cd\u65b0\u4e0b\u8f7d\u8d44\u6e90\uff0c\u800c\u76f4\u63a5\u4ece\u5185\u5b58\u4e2d\u83b7\u53d6</li> <li>disk cache \u5c06\u8d44\u6e90\u7f13\u5b58\u5230\u78c1\u76d8\u4e2d\uff0c\u7b49\u5f85\u4e0b\u6b21\u8bbf\u95ee\u65f6\u4e0d\u9700\u8981\u91cd\u65b0\u4e0b\u8f7d\u8d44\u6e90\uff0c\u800c\u76f4\u63a5\u4ece\u78c1\u76d8\u4e2d\u83b7\u53d6</li> </ul> <table> <thead> <tr> <th>-</th> <th>memory cache</th> <th>disk cache</th> </tr> </thead> <tbody><tr> <td>\u76f8\u540c\u70b9</td> <td>\u53ea\u80fd\u5b58\u50a8\u4e00\u4e9b\u6d3e\u751f\u7c7b\u8d44\u6e90\u6587\u4ef6</td> <td>\u53ea\u80fd\u5b58\u50a8\u4e00\u4e9b\u6d3e\u751f\u7c7b\u8d44\u6e90\u6587\u4ef6</td> </tr> <tr> <td>\u4e0d\u540c\u70b9</td> <td>\u9000\u51fa\u8fdb\u7a0b\u65f6\u6570\u636e\u4f1a\u88ab\u6e05\u9664</td> <td>\u9000\u51fa\u8fdb\u7a0b\u65f6\u6570\u636e\u4e0d\u4f1a\u88ab\u6e05\u9664</td> </tr> <tr> <td>\u5b58\u50a8\u8d44\u6e90</td> <td>\u4e00\u822c\u811a\u672c\u3001\u5b57\u4f53\u3001\u56fe\u7247\u4f1a\u5b58\u5728\u5185\u5b58\u5f53\u4e2d</td> <td>\u4e00\u822c\u975e\u811a\u672c\u4f1a\u5b58\u5728\u5185\u5b58\u5f53\u4e2d\uff0c\u5982 css \u7b49</td> </tr> </tbody></table> <blockquote> <p>\u56e0\u4e3a CSS \u6587\u4ef6\u52a0\u8f7d\u4e00\u6b21\u5c31\u53ef\u6e32\u67d3\u51fa\u6765,\u6211\u4eec\u4e0d\u4f1a\u9891\u7e41\u8bfb\u53d6\u5b83,\u6240\u4ee5\u5b83\u4e0d\u9002\u5408\u7f13\u5b58\u5230\u5185\u5b58\u4e2d,\u4f46\u662f js \u4e4b\u7c7b\u7684\u811a\u672c\u5374\u968f\u65f6\u53ef\u80fd\u4f1a\u6267\u884c,\u5982\u679c\u811a\u672c\u5728\u78c1\u76d8\u5f53\u4e2d,\u6211\u4eec\u5728\u6267\u884c\u811a\u672c\u7684\u65f6\u5019\u9700\u8981\u4ece\u78c1\u76d8\u53d6\u5230\u5185\u5b58\u4e2d\u6765,\u8fd9\u6837 IO \u5f00\u9500\u5c31\u5f88\u5927\u4e86,\u6709\u53ef\u80fd\u5bfc\u81f4\u6d4f\u89c8\u5668\u5931\u53bb\u54cd\u5e94\u3002</p> </blockquote> <p><strong>\u4e09\u7ea7\u7f13\u5b58\u539f\u7406 (\u8bbf\u95ee\u7f13\u5b58\u4f18\u5148\u7ea7)</strong></p> <ul> <li>\u5148\u5728\u5185\u5b58\u4e2d\u67e5\u627e,\u5982\u679c\u6709,\u76f4\u63a5\u52a0\u8f7d</li> <li>\u5982\u679c\u5185\u5b58\u4e2d\u4e0d\u5b58\u5728,\u5219\u5728\u786c\u76d8\u4e2d\u67e5\u627e,\u5982\u679c\u6709\u76f4\u63a5\u52a0\u8f7d</li> <li>\u5982\u679c\u786c\u76d8\u4e2d\u4e5f\u6ca1\u6709,\u90a3\u4e48\u5c31\u8fdb\u884c\u7f51\u7edc\u8bf7\u6c42</li> <li>\u8bf7\u6c42\u83b7\u53d6\u7684\u8d44\u6e90\u7f13\u5b58\u5230\u786c\u76d8\u548c\u5185\u5b58</li> </ul> <h2 id="2-\u7f13\u5b58\u7c7b\u578b">2 \u7f13\u5b58\u7c7b\u578b</h2> <p>\u5f3a\u7f13\u5b58\uff1a</p> <ul> <li>Expires\uff0c\u662f http1.0 \u65f6\u7684\u89c4\u8303\uff0c\u5b83\u7684\u503c\u4e3a\u4e00\u4e2a\u7edd\u5bf9\u65f6\u95f4\u7684 GMT \u683c\u5f0f\u7684\u65f6\u95f4\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u8d44\u6e90\u7684\u5931\u6548\u65f6\u95f4</li> <li>Cache-Control\uff0c http1.1 \u65f6\u51fa\u73b0\u7684 header \u4fe1\u606f\uff0c\u4e3b\u8981\u662f\u5229\u7528\u8be5\u5b57\u6bb5\u7684 max-age \u503c\u6765\u8fdb\u884c\u5224\u65ad\uff0c\u5b83\u662f\u4e00\u4e2a\u76f8\u5bf9\u65f6\u95f4</li> </ul> <p>\u534f\u5546\u7f13\u5b58\uff1a</p> <ul> <li>Last-Modify/If-Modify-Since\uff0c\u662f\u4e00\u4e2a\u65f6\u95f4\u6807\u8bc6\u8be5\u8d44\u6e90\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4\uff0c\u5f53\u6d4f\u89c8\u5668\u518d\u6b21\u8bf7\u6c42\u8be5\u8d44\u6e90\u65f6\uff0crequest \u7684\u8bf7\u6c42\u5934\u4e2d\u4f1a\u5305\u542b If-Modify-Since\uff0c\u8be5\u503c\u4e3a\u7f13\u5b58\u4e4b\u524d\u8fd4\u56de\u7684 Last-Modify</li> <li>ETag/If-None-Match\uff0c\u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u6821\u9a8c\u7801\uff0c\u8d44\u6e90\u53d8\u5316\u90fd\u4f1a\u5bfc\u81f4 ETag \u53d8\u5316\uff0c\u670d\u52a1\u5668\u6839\u636e If-None-Match \u503c\u6765\u5224\u65ad\u662f\u5426\u547d\u4e2d\u7f13\u5b58</li> </ul> <h2 id="3-\u5f3a\u7f13\u5b58">3 \u5f3a\u7f13\u5b58</h2> <p>\u6d4f\u89c8\u5668\u5728\u52a0\u8f7d\u8d44\u6e90\u65f6\uff0c\u4f1a\u5148\u6839\u636e\u672c\u5730\u7f13\u5b58\u8d44\u6e90\u7684 header \u4e2d\u7684\u4fe1\u606f\u5224\u65ad\u662f\u5426\u547d\u4e2d\u5f3a\u7f13\u5b58\uff0c\u5982\u679c\u547d\u4e2d\u5219\u76f4\u63a5\u4f7f\u7528\u7f13\u5b58\u4e2d\u7684\u8d44\u6e90\u4e0d\u4f1a\u518d\u5411\u670d\u52a1\u5668\u53d1\u9001\u8bf7\u6c42</p> <h3 id="31-expires">3.1 Expires</h3> <p>\u8be5\u5b57\u6bb5\u662f http1.0 \u65f6\u7684\u89c4\u8303\uff0c\u5b83\u7684\u503c\u4e3a\u4e00\u4e2a\u7edd\u5bf9\u65f6\u95f4\u7684 GMT \u683c\u5f0f\u7684\u65f6\u95f4\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u65f6\u95f4\u4ee3\u8868\u7740\u8fd9\u4e2a\u8d44\u6e90\u7684\u5931\u6548\u65f6\u95f4\uff0c\u5728\u6b64\u65f6\u95f4\u4e4b\u524d\uff0c\u5373\u547d\u4e2d\u7f13\u5b58</p> <p><img src="'+n+'" alt=""></p> <p>\u7f3a\u70b9\uff1a</p> <blockquote> <p>\u7531\u4e8e\u5931\u6548\u65f6\u95f4\u662f\u4e00\u4e2a\u7edd\u5bf9\u65f6\u95f4\uff0c\u6240\u4ee5\u5f53\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u65f6\u95f4\u504f\u5dee\u8f83\u5927\u65f6\uff0c\u5c31\u4f1a\u5bfc\u81f4\u7f13\u5b58\u6df7\u4e71</p> </blockquote> <h3 id="32-cache-control">3.2 Cache-Control</h3> <p>Cache-Control \u662f http1.1 \u65f6\u51fa\u73b0\u7684 header \u4fe1\u606f\uff0c\u4e3b\u8981\u662f\u5229\u7528\u8be5\u5b57\u6bb5\u7684 max-age \u503c\u6765\u8fdb\u884c\u5224\u65ad\uff0c\u5b83\u662f\u4e00\u4e2a\u76f8\u5bf9\u65f6\u95f4\uff0c\u4f8b\u5982 Cache-Control:max-age=3600\uff0c\u4ee3\u8868\u7740\u8d44\u6e90\u7684\u6709\u6548\u671f\u662f 3600 \u79d2</p> <p><img src="'+f+'" alt=""></p> <p><strong>\u5e38\u7528\u503c\uff1a</strong></p> <ul> <li>no-cache\uff1a\u9700\u8981\u8fdb\u884c\u534f\u5546\u7f13\u5b58\uff0c\u53d1\u9001\u8bf7\u6c42\u5230\u670d\u52a1\u5668\u786e\u8ba4\u662f\u5426\u4f7f\u7528\u7f13\u5b58</li> <li>no-store\uff1a\u7981\u6b62\u4f7f\u7528\u7f13\u5b58\uff0c\u6bcf\u4e00\u6b21\u90fd\u8981\u91cd\u65b0\u8bf7\u6c42\u6570\u636e</li> <li>public\uff1a\u53ef\u4ee5\u88ab\u6240\u6709\u7684\u7528\u6237\u7f13\u5b58\uff0c\u5305\u62ec\u7ec8\u7aef\u7528\u6237\u548c CDN \u7b49\u4e2d\u95f4\u4ee3\u7406\u670d\u52a1\u5668</li> <li>private\uff1a\u53ea\u80fd\u88ab\u7ec8\u7aef\u7528\u6237\u7684\u6d4f\u89c8\u5668\u7f13\u5b58\uff0c\u4e0d\u5141\u8bb8 CDN \u7b49\u4e2d\u7ee7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5176\u7f13\u5b58</li> <li>Cache-Control \u4e0e Expires \u53ef\u4ee5\u5728\u670d\u52a1\u7aef\u914d\u7f6e\u540c\u65f6\u542f\u7528\uff0c\u540c\u65f6\u542f\u7528\u7684\u65f6\u5019 Cache-Control \u4f18\u5148\u7ea7\u9ad8</li> </ul> <h2 id="4-\u534f\u5546\u7f13\u5b58">4 \u534f\u5546\u7f13\u5b58</h2> <p>\u5f53\u5f3a\u7f13\u5b58\u6ca1\u6709\u547d\u4e2d\u7684\u65f6\u5019\uff0c\u6d4f\u89c8\u5668\u4f1a\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5230\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u6839\u636e header \u4e2d\u7684\u90e8\u5206\u4fe1\u606f\u6765\u5224\u65ad\u662f\u5426\u547d\u4e2d\u7f13\u5b58\u3002\u5982\u679c\u547d\u4e2d\uff0c\u5219\u8fd4\u56de 304 \uff0c\u544a\u8bc9\u6d4f\u89c8\u5668\u8d44\u6e90\u672a\u66f4\u65b0\uff0c\u53ef\u4f7f\u7528\u672c\u5730\u7684\u7f13\u5b58</p> <h3 id="41-last-modifyif-modify-since">4.1 Last-Modify/If-Modify-Since</h3> <p>\u6d4f\u89c8\u5668\u7b2c\u4e00\u6b21\u8bf7\u6c42\u4e00\u4e2a\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u670d\u52a1\u5668\u8fd4\u56de\u7684 header \u4e2d\u4f1a\u52a0\u4e0a Last-Modify\uff0cLast-modify \u662f\u4e00\u4e2a\u65f6\u95f4\u6807\u8bc6\u8be5\u8d44\u6e90\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4</p> <p>\u5f53\u6d4f\u89c8\u5668\u518d\u6b21\u8bf7\u6c42\u8be5\u8d44\u6e90\u65f6\uff0crequest \u7684\u8bf7\u6c42\u5934\u4e2d\u4f1a\u5305\u542b If-Modify-Since\uff0c\u8be5\u503c\u4e3a\u7f13\u5b58\u4e4b\u524d\u8fd4\u56de\u7684 Last-Modify\u3002\u670d\u52a1\u5668\u6536\u5230 If-Modify-Since \u540e\uff0c\u6839\u636e\u8d44\u6e90\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4\u5224\u65ad\u662f\u5426\u547d\u4e2d\u7f13\u5b58</p> <p>\u5982\u679c\u547d\u4e2d\u7f13\u5b58\uff0c\u5219\u8fd4\u56de 304\uff0c\u5e76\u4e14\u4e0d\u4f1a\u8fd4\u56de\u8d44\u6e90\u5185\u5bb9\uff0c\u5e76\u4e14\u4e0d\u4f1a\u8fd4\u56de Last-Modify</p> <p><img src="'+u+'" alt=""> (response header) <img src="'+g+'" alt=""> (request header)</p> <p><strong>\u7f3a\u70b9\uff1a</strong></p> <ul> <li>\u77ed\u65f6\u95f4\u5185\u8d44\u6e90\u53d1\u751f\u4e86\u6539\u53d8\uff0cLast-Modified \u5e76\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316</li> <li>\u5982\u679c\u8fd9\u4e2a\u8d44\u6e90\u5728\u4e00\u4e2a\u5468\u671f\u5185\u4fee\u6539\u56de\u539f\u6765\u7684\u6837\u5b50\u4e86\uff0c\u6211\u4eec\u8ba4\u4e3a\u662f\u53ef\u4ee5\u4f7f\u7528\u7f13\u5b58\u7684\uff0c\u4f46\u662f Last-Modified \u4f1a\u6539\u53d8</li> </ul> <p>\u53c2\u8003\u6587\u6863\uff1a</p> <p><a href="https://juejin.im/post/5c4528a6f265da611a4822cc#heading-12">https://juejin.im/post/5c4528a6f265da611a4822cc#heading-12</a></p> <h3 id="42-etagif-none-match">4.2 ETag/If-None-Match</h3> <p>Etag/If-None-Match \u8fd4\u56de\u7684\u662f\u4e00\u4e2a\u6821\u9a8c\u7801\u3002ETag \u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e00\u4e2a\u8d44\u6e90\u662f\u552f\u4e00\u7684\uff0c\u8d44\u6e90\u53d8\u5316\u90fd\u4f1a\u5bfc\u81f4 ETag \u53d8\u5316\u3002\u670d\u52a1\u5668\u6839\u636e If-None-Match \u503c\u6765\u5224\u65ad\u662f\u5426\u547d\u4e2d\u7f13\u5b58\u3002</p> <p>Last-Modified \u4e0e ETag \u662f\u53ef\u4ee5\u4e00\u8d77\u4f7f\u7528\u7684\uff0c\u670d\u52a1\u5668\u4f1a\u4f18\u5148\u9a8c\u8bc1 ETag\uff0c\u4e00\u81f4\u7684\u60c5\u51b5\u4e0b\uff0c\u624d\u4f1a\u7ee7\u7eed\u6bd4\u5bf9 Last-Modified\uff0c\u6700\u540e\u624d\u51b3\u5b9a\u662f\u5426\u8fd4\u56de 304</p> <p><img src="'+M+'" alt=""> (response header) <img src="'+m+'" alt=""> (request header)</p> <h2 id="5-\u6ce8\u610f\u70b9">5 \u6ce8\u610f\u70b9</h2> <ul> <li>\u5f3a\u7f13\u5b58\u548c\u534f\u5546\u7f13\u5b58\u90fd\u9700\u8981\u670d\u52a1\u7aef\u8fd4\u56de\u76f8\u5e94\u7684 response header</li> <li>\u534f\u5546\u7f13\u5b58\u9700\u8981\u670d\u52a1\u7aef\u53bb\u5bf9\u6bd4 requese header \u4e2d\u7684 If-Modify-Since/If-None-Match\uff0c\u7136\u540e\u8fd4\u56de\u8d44\u6e90\u6216 304</li> </ul> <p>\u5982 express \u4f7f\u7528\u7684 <code>server-static</code> \u4e2d\u95f4\u4ef6\u7684\u914d\u7f6e\uff1a</p> <pre><code class="language-javascript">app.use(\n  serverStatic(&#39;static&#39;, {\n    etag: true,\n    lastModified: true,\n    maxAge: 0\n  })\n);</code></pre> ';t.exports=y}}]);