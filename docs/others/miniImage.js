(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["docs/others/miniImage"],{knEj:function(e,a,i){var n=i("Rxnk"),c=i("0lD5"),g=i("aCNc"),t=i("AgU0"),o=i("Xf/i"),p=n(c),s=n(g),d=n(t),r=n(o),m='<h1 id="\u524d\u7aef\u538b\u7f29\u56fe\u7247">\u524d\u7aef\u538b\u7f29\u56fe\u7247</h1> <h2 id="\u524d\u8a00">\u524d\u8a00</h2> <p>\u5f00\u53d1\u7f16\u7a0b\u5e73\u53f0\u7684\u65f6\uff0c\u6709\u4e2a\u9700\u6c42\u662f\u4fdd\u5b58\u4f5c\u54c1\u65f6\u63d0\u4ea4\u4f5c\u54c1\u7684\u622a\u56fe\uff0c\u5728 firefox \u4e0b\u9762\u62ff\u5230\u7684\u56fe\u7247\u4f1a\u6bd4\u8f83\u5927\uff0c\u8d85\u8fc7\u4e86\u540e\u53f0\u8bbe\u7684\u9650\u5236\uff0c\u540e\u7aef\u5927\u4f6c\u60f3\u524d\u7aef\u53bb\u538b\u7f29\uff5e</p> <p>\u4e0d\u8fc7\u8fd9\u4e2a\u573a\u666f\u524d\u7aef\u538b\u7f29\u8fd8\u662f\u6bd4\u8f83\u9002\u5408\uff0c\u9700\u6c42\u4e0a\u5bf9\u56fe\u7247\u8d28\u91cf\u8981\u6c42\u4e0d\u9ad8\u3002\u4e00\u662f\u53ef\u4ee5\u51cf\u5c0f\u4e0a\u4f20\u56fe\u7247\u7684\u5927\u5c0f\uff0c\u4e8c\u662f\u7edf\u4e00\u4e0a\u4f20\u56fe\u7247\u7684\u5c3a\u5bf8\u3002</p> <p>\u524d\u7aef\u538b\u7f29\u56fe\u7247\u662f\u6709\u635f\u538b\u7f29\uff0c\u5bf9\u538b\u7f29\u8981\u6c42\u6bd4\u8f83\u9ad8\u7684\u8bdd\u6700\u597d\u653e\u5230\u540e\u7aef\uff08\u53ef\u80fd\u524d\u7aef\u4e5f\u6709\u6bd4\u8f83\u597d\u7684\u538b\u7f29\u5de5\u5177\uff5e\uff09\u3002</p> <h2 id="\u5b9e\u73b0\u539f\u7406">\u5b9e\u73b0\u539f\u7406</h2> <p>\u8981\u60f3\u524d\u7aef\u5b9e\u73b0\u56fe\u7247\u7684\u538b\u7f29\u6548\u679c\uff0c\u539f\u7406\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u6838\u5fc3 API \u5c31\u662f\u4f7f\u7528 canvas \u7684 drawImage()\u65b9\u6cd5\u3002\u5148\u6765\u770b\u4e00\u4e0b\u9700\u8981\u7528\u5230\u7684 api</p> <h3 id="image">Image</h3> <p>Image() \u51fd\u6570\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684 HTMLImageElement \u5b9e\u4f8b\u3002</p> <p>\u5b83\u7684\u529f\u80fd\u7b49\u4ef7\u4e8e document.createElement(&#39;img&#39;)</p> <p><strong>\u8bed\u6cd5\uff1a</strong></p> <pre><code class="language-javascript">let img = new Image();\nimg.src = &#39;&#39;; // \u56fe\u7247\u5730\u5740/base64;\n\nimg.onload = () =&gt; {\n  // do something\n};</code></pre> <h3 id="ctxdrawimage">ctx.drawImage</h3> <p>\u5982\u65b9\u6cd5\u540d\uff0c\u5373\u5728 canvas \u4e0a\u7ed8\u5236\u56fe\u7247\u3002</p> <p><strong>\u8bed\u6cd5\uff1a</strong></p> <pre><code class="language-javascript">void ctx.drawImage(image, dx, dy);\nvoid ctx.drawImage(image, dx, dy, dWidth, dHeight);\nvoid ctx.drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);</code></pre> <p><strong>\u53c2\u6570\uff1a</strong></p> <ul> <li><code>image</code> \u7ed8\u5236\u5230\u4e0a\u4e0b\u6587\u7684\u5143\u7d20</li> <li><code>sx</code> image \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u5de6\u4e0a\u89d2 X \u8f74\u5750\u6807</li> <li><code>sy</code> image \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u5de6\u4e0a\u89d2 Y \u8f74\u5750\u6807</li> <li><code>sWidth</code> image \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u5bbd\u5ea6</li> <li><code>sHeight</code> image \u7684\u77e9\u5f62\uff08\u88c1\u526a\uff09\u9009\u62e9\u6846\u7684\u9ad8\u5ea6</li> <li><code>dx</code> image \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807 canvas \u4e0a X \u8f74\u5750\u6807</li> <li><code>dy</code> image \u7684\u5de6\u4e0a\u89d2\u5728\u76ee\u6807 canvas \u4e0a Y \u8f74\u5750\u6807</li> <li><code>dWidth</code> image \u5728\u76ee\u6807 canvas \u4e0a\u7ed8\u5236\u7684\u5bbd\u5ea6\u3002 \u5141\u8bb8\u5bf9\u7ed8\u5236\u7684 image \u8fdb\u884c\u7f29\u653e\u3002 \u5982\u679c\u4e0d\u8bf4\u660e\uff0c \u5728\u7ed8\u5236\u65f6 image \u5bbd\u5ea6\u4e0d\u4f1a\u7f29\u653e</li> <li><code>dHeight</code> image \u5728\u76ee\u6807 canvas \u4e0a\u7ed8\u5236\u7684\u9ad8\u5ea6</li> </ul> <p>\u8fd9\u51e0\u4e2a\u53c2\u6570\u8bf4\u660e\u4e00\u4e0b\uff0c\u53c2\u6570\u7684\u4f7f\u7528\u5fc5\u987b\u53c2\u7167\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u5373\u5fc5\u987b\u662f 3/5/9 \u4e2a\u53c2\u6570\u3002</p> <p><strong>\u4e3e\u4f8b\uff1a</strong></p> <p>\u539f\u56fe\u5927\u5c0f\u4e3a 1366 * 768\uff0ccanvas \u5927\u5c0f\u4e3a 500 * 400</p> <p><img src="'+p+'" alt="\u539f\u56fe"></p> <p><strong>3 \u4e2a\u53c2\u6570</strong></p> <pre><code class="language-javascript">context.drawImage(img, 20, 20);</code></pre> <p>\u6548\u679c\u5982\u4e0b\u56fe\uff1a</p> <p><img src="'+s+'" alt="image"></p> <p>\u56fe\u7247\u4ece canvas \u7684\u5de6\u4e0a\u89d2 20px \u5904\u5f00\u59cb\u6e32\u67d3\uff0c\u56fe\u7247\u53ea\u663e\u793a\u5de6\u4e0a\u89d2\u7684\u4e00\u90e8\u5206\u3002</p> <p><strong>5 \u4e2a\u53c2\u6570</strong></p> <pre><code class="language-javascript">context.drawImage(img, 100, 50, 300, 300);</code></pre> <p><img src="'+d+'" alt="image"></p> <p>\u6307\u5b9a\u4e86\u56fe\u7247\u5728\u753b\u5e03\u4e2d\u7684\u4f4d\u7f6e\u548c\u56fe\u7247\u5728\u753b\u5e03\u4e2d\u7684\u5927\u5c0f\uff0c\u4e0a\u9762\u6307\u5b9a\u7684\u662f 300*300\uff0c\u53ef\u4ee5\u770b\u5230\u56fe\u7247\u88ab\u7f29\u5c0f\u548c\u538b\u7f29\u4e86</p> <p><strong>9 \u4e2a\u53c2\u6570</strong></p> <pre><code class="language-javascript">context.drawImage(img, 420, 0, 500, 500, 100, 50, 300, 300);</code></pre> <p><img src="'+r+'" alt="image"></p> <p>\u4e0a\u9762\u7684\u53c2\u6570\u8868\u793a\u4ece\u56fe\u7247\u7684 (420, 0) \u5904\u622a\u53d6 500*500 \u5927\u5c0f\u7684\u56fe\u7247\u5728 canvas \u7684 (100, 500) \u4ee5 300*300 \u5927\u5c0f\u8fdb\u884c\u7ed8\u5236</p> <h3 id="canvastodataurl">canvas.toDataURL</h3> <p>\u5c06 canvas \u8f6c\u56fe\u7247\uff0c\u8fd4\u56de base64</p> <p><strong>\u8bed\u6cd5\uff1a</strong></p> <pre><code class="language-javascript">canvas.toDataURL(type, encoderOptions);</code></pre> <p><strong>\u53c2\u6570\uff1a</strong></p> <ul> <li><code>type</code> \u56fe\u7247\u683c\u5f0f\uff0c\u9ed8\u8ba4\u4e3a image/png</li> <li><code>encoderOptions</code> \u5728\u6307\u5b9a\u56fe\u7247\u683c\u5f0f\u4e3a image/jpeg \u6216 image/webp \u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4ece 0 \u5230 1 \u7684\u533a\u95f4\u5185\u9009\u62e9\u56fe\u7247\u7684\u8d28\u91cf\u3002\u5982\u679c\u8d85\u51fa\u53d6\u503c\u8303\u56f4\uff0c\u5c06\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u503c 0.92\u3002\u5176\u4ed6\u53c2\u6570\u4f1a\u88ab\u5ffd\u7565</li> </ul> <h2 id="\u4ee3\u7801">\u4ee3\u7801</h2> <p>\u4e86\u89e3\u539f\u7406\u540e\uff0c\u4ee3\u7801\u4e5f\u5f88\u7b80\u5355\uff5e</p> <pre><code class="language-javascript">/**\n * @desc \u8fd4\u56de\u6307\u5b9a\u5927\u5c0f\u7684\u56fe\u7247\n */\nfunction minImg({ imgBase64, width, height, type = &#39;image/jpeg&#39;, quality = &#39;0.92&#39; }) {\n  return new Promise((resolve, reject) =&gt; {\n    try {\n      const img = new Image();\n      const canvas = document.createElement(&#39;canvas&#39;);\n      const context = canvas.getContext(&#39;2d&#39;);\n\n      canvas.width = width;\n      canvas.height = height;\n      img.src = imgBase64;\n\n      img.onload = () =&gt; {\n        context.drawImage(img, 0, 0, width, height);\n        const res = canvas.toDataURL(type, quality);\n        resolve(res);\n      };\n    } catch (err) {\n      reject(err);\n    }\n  });\n}</code></pre> ';e.exports=m}}]);